var p=class{withFields(t){let r=Object.keys(this).map(n=>n in t?t[n]:this[n]);return new this.constructor(...r)}},z=class{static fromArray(t,r){let n=r||new rr;for(let i=t.length-1;i>=0;--i)n=new mt(t[i],n);return n}[Symbol.iterator](){return new Mn(this)}toArray(){return[...this]}atLeastLength(t){for(let r of this){if(t<=0)return!0;t--}return t<=0}hasLength(t){for(let r of this){if(t<=0)return!1;t--}return t===0}countLength(){let t=0;for(let r of this)t++;return t}};function m(e,t){return new mt(e,t)}function u(e,t){return z.fromArray(e,t)}var Mn=class{#e;constructor(t){this.#e=t}next(){if(this.#e instanceof rr)return{done:!0};{let{head:t,tail:r}=this.#e;return this.#e=r,{value:t,done:!1}}}},rr=class extends z{},mt=class extends z{constructor(t,r){super(),this.head=t,this.tail=r}},nr=class e{constructor(t){if(!(t instanceof Uint8Array))throw"BitArray can only be constructed from a Uint8Array";this.buffer=t}get length(){return this.buffer.length}byteAt(t){return this.buffer[t]}floatFromSlice(t,r,n){return El(this.buffer,t,r,n)}intFromSlice(t,r,n,i){return jl(this.buffer,t,r,n,i)}binaryFromSlice(t,r){return new e(this.buffer.slice(t,r))}sliceAfter(t){return new e(this.buffer.slice(t))}};function jl(e,t,r,n,i){let s=0;if(n)for(let o=t;o<r;o++)s=s*256+e[o];else for(let o=r-1;o>=t;o--)s=s*256+e[o];if(i){let l=2**((r-t)*8-1);s>=l&&(s-=l*2)}return s}function El(e,t,r,n){let i=new DataView(e.buffer),s=r-t;if(s===8)return i.getFloat64(t,!n);if(s===4)return i.getFloat32(t,!n);{let o=`Sized floats must be 32-bit or 64-bit on JavaScript, got size of ${s*8} bits`;throw new globalThis.Error(o)}}var He=class e extends p{static isResult(t){return t instanceof e}},c=class extends He{constructor(t){super(),this[0]=t}isOk(){return!0}},f=class extends He{constructor(t){super(),this[0]=t}isOk(){return!1}};function b(e,t){let r=[e,t];for(;r.length;){let n=r.pop(),i=r.pop();if(n===i)continue;if(!Qi(n)||!Qi(i)||!Pl(n,i)||Sl(n,i)||Cl(n,i)||ql(n,i)||Ml(n,i)||zl(n,i)||Nl(n,i))return!1;let o=Object.getPrototypeOf(n);if(o!==null&&typeof o.equals=="function")try{if(n.equals(i))continue;return!1}catch{}let[l,a]=Tl(n);for(let d of l(n))r.push(a(n,d),a(i,d))}return!0}function Tl(e){if(e instanceof Map)return[t=>t.keys(),(t,r)=>t.get(r)];{let t=e instanceof globalThis.Error?["message"]:[];return[r=>[...t,...Object.keys(r)],(r,n)=>r[n]]}}function Sl(e,t){return e instanceof Date&&(e>t||e<t)}function Cl(e,t){return e.buffer instanceof ArrayBuffer&&e.BYTES_PER_ELEMENT&&!(e.byteLength===t.byteLength&&e.every((r,n)=>r===t[n]))}function ql(e,t){return Array.isArray(e)&&e.length!==t.length}function Ml(e,t){return e instanceof Map&&e.size!==t.size}function zl(e,t){return e instanceof Set&&(e.size!=t.size||[...e].some(r=>!t.has(r)))}function Nl(e,t){return e instanceof RegExp&&(e.source!==t.source||e.flags!==t.flags)}function Qi(e){return typeof e=="object"&&e!==null}function Pl(e,t){return typeof e!="object"&&typeof t!="object"&&(!e||!t)||[Promise,WeakSet,WeakMap,Function].some(n=>e instanceof n)?!1:e.constructor===t.constructor}function Le(e,t,r,n,i,s){let o=new globalThis.Error(i);o.gleam_error=e,o.module=t,o.line=r,o.fn=n;for(let l in s)o[l]=s[l];return o}var $=class extends p{constructor(t){super(),this[0]=t}},_=class extends p{};function Ue(e,t){if(e instanceof $){let r=e[0];return new c(r)}else return new f(t)}function ht(e){if(e.isOk()){let t=e[0];return new $(t)}else return new _}function ve(e,t){return e instanceof $?e[0]:t}function ir(e,t){if(e instanceof $){let r=e[0];return new $(t(r))}else return new _}var We=class extends p{constructor(t,r){super(),this.content=t,this.submatches=r}},sr=class extends p{constructor(t,r){super(),this.error=t,this.byte_index=r}},or=class extends p{constructor(t,r){super(),this.case_insensitive=t,this.multi_line=r}};function es(e,t){return ts(e,t)}function lr(e,t){return rs(e,t)}function wt(e){return e>=0?e:e*-1}function Oe(e){return is(e)}function j(e){return ss(e)}function S(e,t){if(e.isOk()){let r=e[0];return new c(t(r))}else{let r=e[0];return new f(r)}}function le(e,t){if(e.isOk()){let r=e[0];return new c(r)}else{let r=e[0];return new f(t(r))}}function N(e,t){if(e.isOk()){let r=e[0];return t(r)}else{let r=e[0];return new f(r)}}function C(e,t){return N(e,t)}function Je(e,t){return e.isOk()?e[0]:t}function os(e){return le(e,t=>{})}function Nn(e,t){if(e.isOk()){let r=e[0];return new c(r)}else return new f(t)}function Fn(){return bt(u([]))}function Te(e){return bt(e)}function In(e){return bt(e)}function yt(e){return e}function Y(e){return e}function Dn(e){return ps(e)}function Ce(e){return Gn(e)}function At(e,t){return ds(e,t)}function Lt(e){let r=Te(e);return Y(r)}function Z(e,t){return fs(e,t)}function vt(e){return cs(e)}function us(e,t,r){let i=cr(e),s=Ot(i,t),o=Bn(s,r);return Lt(o)}function as(e,t,r){if(r<0)return"";if(t<0){let s=Dn(e)+t;return s<0?"":us(e,s,r)}else return us(e,t,r)}function dr(e,t){return t<0?e:as(e,t,Dn(e)-t)}var W=class extends p{constructor(t,r,n){super(),this.expected=t,this.found=r,this.path=n}};function _r(e){return new c(e)}function jt(e){return Vn(e)}function ms(e){return ys(e)}function Wl(e){return ks(e)}function hs(e){return t=>As(t,e)}function $s(e,t){let r=e===1?"":"s",n=(()=>{let i=u(["Tuple of at least ",j(e)," element",r]),s=Te(i),o=Y(s);return new W(o,jt(t),u([]))})();return new f(u([n]))}function $r(e){return t=>{if(e.hasLength(0))return new f(u([new W("another type",jt(t),u([]))]));{let r=e.head,n=e.tail,i=r(t);if(i.isOk()){let s=i[0];return new c(s)}else return $r(n)(t)}}}function ne(e){return e.isOk()?u([]):e[0]}function Un(e,t){return r=>{let n=t(r);if(n.isOk()){let i=n[0];return new c(e(i))}else{let i=n;return new f(ne(i))}}}function Wn(e,t){let r=t,n=$r(u([q,s=>S(ms(s),j)])),i=(()=>{let s=n(r);if(s.isOk())return s[0];{let o=u(["<",jt(r),">"]),l=Te(o);return Y(l)}})();return e.withFields({path:m(i,e.path)})}function ae(e){return t=>N(Wl(t),r=>{let i=gt(r,e);return Jn(i,s=>Wn(s,"*"))})}function Jn(e,t){return le(e,r=>E(r,t))}function q(e){return gs(e)}function M(e,t){return r=>{let n=new W("field","nothing",u([]));return N(Ls(r,e),i=>{let o=Ue(i,u([n])),l=N(o,t);return Jn(l,a=>Wn(a,e))})}}function ws(e,t){return r=>N(bs(r),n=>{let i=kt(n);return N(e>=0?e<i?Hn(n,e):$s(e+1,r):wt(e)<=i?Hn(n,i+e):$s(wt(e),r),s=>{let o=t(s);return Jn(o,l=>Wn(l,e))})})}function Kn(e,t,r,n){return i=>{let s=t(i),o=r(i),l=n(i);if(s.isOk()&&o.isOk()&&l.isOk()){let a=s[0],d=o[0],h=l[0];return new c(e(a,d,h))}else{let a=s,d=o,h=l;return new f(Yn(u([ne(a),ne(d),ne(h)])))}}}function xs(e,t,r,n,i,s,o,l){return a=>{let d=t(a),h=r(a),w=n(a),g=i(a),L=s(a),K=o(a),ke=l(a);if(d.isOk()&&h.isOk()&&w.isOk()&&g.isOk()&&L.isOk()&&K.isOk()&&ke.isOk()){let Ae=d[0],de=h[0],x=w[0],y=g[0],T=L[0],F=K[0],_e=ke[0];return new c(e(Ae,de,x,y,T,F,_e))}else{let Ae=d,de=h,x=w,y=g,T=L,F=K,_e=ke;return new f(Yn(u([ne(Ae),ne(de),ne(x),ne(y),ne(T),ne(F),ne(_e)])))}}}var vs=new WeakMap,Zn=new DataView(new ArrayBuffer(8)),Xn=0;function Qn(e){let t=vs.get(e);if(t!==void 0)return t;let r=Xn++;return Xn===2147483647&&(Xn=0),vs.set(e,r),r}function ei(e,t){return e^t+2654435769+(e<<6)+(e>>2)|0}function ri(e){let t=0,r=e.length;for(let n=0;n<r;n++)t=Math.imul(31,t)+e.charCodeAt(n)|0;return t}function Os(e){Zn.setFloat64(0,e);let t=Zn.getInt32(0),r=Zn.getInt32(4);return Math.imul(73244475,t>>16^t)^r}function Kl(e){return ri(e.toString())}function Vl(e){let t=Object.getPrototypeOf(e);if(t!==null&&typeof t.hashCode=="function")try{let n=e.hashCode(e);if(typeof n=="number")return n}catch{}if(e instanceof Promise||e instanceof WeakSet||e instanceof WeakMap)return Qn(e);if(e instanceof Date)return Os(e.getTime());let r=0;if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),Array.isArray(e)||e instanceof Uint8Array)for(let n=0;n<e.length;n++)r=Math.imul(31,r)+Q(e[n])|0;else if(e instanceof Set)e.forEach(n=>{r=r+Q(n)|0});else if(e instanceof Map)e.forEach((n,i)=>{r=r+ei(Q(n),Q(i))|0});else{let n=Object.keys(e);for(let i=0;i<n.length;i++){let s=n[i],o=e[s];r=r+ei(Q(o),ri(s))|0}}return r}function Q(e){if(e===null)return 1108378658;if(e===void 0)return 1108378659;if(e===!0)return 1108378657;if(e===!1)return 1108378656;switch(typeof e){case"number":return Os(e);case"string":return ri(e);case"bigint":return Kl(e);case"object":return Vl(e);case"symbol":return Qn(e);case"function":return Qn(e);default:return 0}}var ce=5,ni=Math.pow(2,ce),Yl=ni-1,Zl=ni/2,Xl=ni/4,D=0,pe=1,J=2,Pe=3,ii={type:J,bitmap:0,array:[]};function Et(e,t){return e>>>t&Yl}function wr(e,t){return 1<<Et(e,t)}function Ql(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),e=e+(e>>4)&252645135,e+=e>>8,e+=e>>16,e&127}function si(e,t){return Ql(e&t-1)}function ee(e,t,r){let n=e.length,i=new Array(n);for(let s=0;s<n;++s)i[s]=e[s];return i[t]=r,i}function eu(e,t,r){let n=e.length,i=new Array(n+1),s=0,o=0;for(;s<t;)i[o++]=e[s++];for(i[o++]=r;s<n;)i[o++]=e[s++];return i}function ti(e,t){let r=e.length,n=new Array(r-1),i=0,s=0;for(;i<t;)n[s++]=e[i++];for(++i;i<r;)n[s++]=e[i++];return n}function js(e,t,r,n,i,s){let o=Q(t);if(o===n)return{type:Pe,hash:o,array:[{type:D,k:t,v:r},{type:D,k:i,v:s}]};let l={val:!1};return Tt(oi(ii,e,o,t,r,l),e,n,i,s,l)}function Tt(e,t,r,n,i,s){switch(e.type){case pe:return tu(e,t,r,n,i,s);case J:return oi(e,t,r,n,i,s);case Pe:return ru(e,t,r,n,i,s)}}function tu(e,t,r,n,i,s){let o=Et(r,t),l=e.array[o];if(l===void 0)return s.val=!0,{type:pe,size:e.size+1,array:ee(e.array,o,{type:D,k:n,v:i})};if(l.type===D)return b(n,l.k)?i===l.v?e:{type:pe,size:e.size,array:ee(e.array,o,{type:D,k:n,v:i})}:(s.val=!0,{type:pe,size:e.size,array:ee(e.array,o,js(t+ce,l.k,l.v,r,n,i))});let a=Tt(l,t+ce,r,n,i,s);return a===l?e:{type:pe,size:e.size,array:ee(e.array,o,a)}}function oi(e,t,r,n,i,s){let o=wr(r,t),l=si(e.bitmap,o);if(e.bitmap&o){let a=e.array[l];if(a.type!==D){let h=Tt(a,t+ce,r,n,i,s);return h===a?e:{type:J,bitmap:e.bitmap,array:ee(e.array,l,h)}}let d=a.k;return b(n,d)?i===a.v?e:{type:J,bitmap:e.bitmap,array:ee(e.array,l,{type:D,k:n,v:i})}:(s.val=!0,{type:J,bitmap:e.bitmap,array:ee(e.array,l,js(t+ce,d,a.v,r,n,i))})}else{let a=e.array.length;if(a>=Zl){let d=new Array(32),h=Et(r,t);d[h]=oi(ii,t+ce,r,n,i,s);let w=0,g=e.bitmap;for(let L=0;L<32;L++){if(g&1){let K=e.array[w++];d[L]=K}g=g>>>1}return{type:pe,size:a+1,array:d}}else{let d=eu(e.array,l,{type:D,k:n,v:i});return s.val=!0,{type:J,bitmap:e.bitmap|o,array:d}}}}function ru(e,t,r,n,i,s){if(r===e.hash){let o=li(e,n);if(o!==-1)return e.array[o].v===i?e:{type:Pe,hash:r,array:ee(e.array,o,{type:D,k:n,v:i})};let l=e.array.length;return s.val=!0,{type:Pe,hash:r,array:ee(e.array,l,{type:D,k:n,v:i})}}return Tt({type:J,bitmap:wr(e.hash,t),array:[e]},t,r,n,i,s)}function li(e,t){let r=e.array.length;for(let n=0;n<r;n++)if(b(t,e.array[n].k))return n;return-1}function hr(e,t,r,n){switch(e.type){case pe:return nu(e,t,r,n);case J:return iu(e,t,r,n);case Pe:return su(e,n)}}function nu(e,t,r,n){let i=Et(r,t),s=e.array[i];if(s!==void 0){if(s.type!==D)return hr(s,t+ce,r,n);if(b(n,s.k))return s}}function iu(e,t,r,n){let i=wr(r,t);if(!(e.bitmap&i))return;let s=si(e.bitmap,i),o=e.array[s];if(o.type!==D)return hr(o,t+ce,r,n);if(b(n,o.k))return o}function su(e,t){let r=li(e,t);if(!(r<0))return e.array[r]}function ui(e,t,r,n){switch(e.type){case pe:return ou(e,t,r,n);case J:return lu(e,t,r,n);case Pe:return uu(e,n)}}function ou(e,t,r,n){let i=Et(r,t),s=e.array[i];if(s===void 0)return e;let o;if(s.type===D){if(!b(s.k,n))return e}else if(o=ui(s,t+ce,r,n),o===s)return e;if(o===void 0){if(e.size<=Xl){let l=e.array,a=new Array(e.size-1),d=0,h=0,w=0;for(;d<i;){let g=l[d];g!==void 0&&(a[h]=g,w|=1<<d,++h),++d}for(++d;d<l.length;){let g=l[d];g!==void 0&&(a[h]=g,w|=1<<d,++h),++d}return{type:J,bitmap:w,array:a}}return{type:pe,size:e.size-1,array:ee(e.array,i,o)}}return{type:pe,size:e.size,array:ee(e.array,i,o)}}function lu(e,t,r,n){let i=wr(r,t);if(!(e.bitmap&i))return e;let s=si(e.bitmap,i),o=e.array[s];if(o.type!==D){let l=ui(o,t+ce,r,n);return l===o?e:l!==void 0?{type:J,bitmap:e.bitmap,array:ee(e.array,s,l)}:e.bitmap===i?void 0:{type:J,bitmap:e.bitmap^i,array:ti(e.array,s)}}return b(n,o.k)?e.bitmap===i?void 0:{type:J,bitmap:e.bitmap^i,array:ti(e.array,s)}:e}function uu(e,t){let r=li(e,t);if(r<0)return e;if(e.array.length!==1)return{type:Pe,hash:e.hash,array:ti(e.array,r)}}function Es(e,t){if(e===void 0)return;let r=e.array,n=r.length;for(let i=0;i<n;i++){let s=r[i];if(s!==void 0){if(s.type===D){t(s.v,s.k);continue}Es(s,t)}}}var Fe=class e{static fromObject(t){let r=Object.keys(t),n=e.new();for(let i=0;i<r.length;i++){let s=r[i];n=n.set(s,t[s])}return n}static fromMap(t){let r=e.new();return t.forEach((n,i)=>{r=r.set(i,n)}),r}static new(){return new e(void 0,0)}constructor(t,r){this.root=t,this.size=r}get(t,r){if(this.root===void 0)return r;let n=hr(this.root,0,Q(t),t);return n===void 0?r:n.v}set(t,r){let n={val:!1},i=this.root===void 0?ii:this.root,s=Tt(i,0,Q(t),t,r,n);return s===this.root?this:new e(s,n.val?this.size+1:this.size)}delete(t){if(this.root===void 0)return this;let r=ui(this.root,0,Q(t),t);return r===this.root?this:r===void 0?e.new():new e(r,this.size-1)}has(t){return this.root===void 0?!1:hr(this.root,0,Q(t),t)!==void 0}entries(){if(this.root===void 0)return[];let t=[];return this.forEach((r,n)=>t.push([n,r])),t}forEach(t){Es(this.root,t)}hashCode(){let t=0;return this.forEach((r,n)=>{t=t+ei(Q(r),Q(n))|0}),t}equals(t){if(!(t instanceof e)||this.size!==t.size)return!1;let r=!0;return this.forEach((n,i)=>{r=r&&b(t.get(i,!n),n)}),r}};var St=void 0,Ts={};function is(e){return/^[-+]?(\d+)$/.test(e)?new c(parseInt(e)):new f(St)}function ss(e){return e.toString()}function ps(e){if(e==="")return 0;let t=ai(e);if(t){let r=0;for(let n of t)r++;return r}else return e.match(/./gsu).length}function cr(e){let t=ai(e);return t?z.fromArray(Array.from(t).map(r=>r.segment)):z.fromArray(e.match(/./gsu))}function ai(e){if(globalThis.Intl&&Intl.Segmenter)return new Intl.Segmenter().segment(e)[Symbol.iterator]()}function cs(e){let t,r=ai(e);return r?t=r.next().value?.segment:t=e.match(/./su)?.[0],t?new c([t,e.slice(t.length)]):new f(St)}function Gn(e){return e.toLowerCase()}function fs(e,t){let r=e[Symbol.iterator](),n=r.next().value||"",i=r.next();for(;!i.done;)n=n+t+i.value,i=r.next();return n}function bt(e){let t="";for(let r of e)t=t+r;return t}function kt(e){return e.length}function ds(e,t){return e.startsWith(t)}var Ms=[" ","	",`
`,"\v","\f","\r","\x85","\u2028","\u2029"].join(""),Mf=new RegExp(`^([${Ms}]*)`,"g"),zf=new RegExp(`([${Ms}]*)$`,"g");function ts(e,t){try{let r="gu";return t.case_insensitive&&(r+="i"),t.multi_line&&(r+="m"),new c(new RegExp(e,r))}catch(r){let n=(r.columnNumber||0)|0;return new f(new sr(r.message,n))}}function rs(e,t){let r=Array.from(t.matchAll(e)).map(n=>{let i=n[0],s=[];for(let o=n.length-1;o>0;o--){if(n[o]){s[o-1]=new $(n[o]);continue}s.length>0&&(s[o-1]=new _)}return new We(i,z.fromArray(s))});return z.fromArray(r)}function zs(){return Fe.new()}function mr(e){return z.fromArray(e.entries())}function Ns(e,t){let r=e.get(t,Ts);return r===Ts?new f(St):new c(r)}function Ps(e,t,r){return r.set(e,t)}function Ss(e){return decodeURIComponent((e||"").replace("+"," "))}function Fs(e){return encodeURIComponent(e).replace("%2B","+")}function Is(e){try{let t=[];for(let r of e.split("&")){let[n,i]=r.split("=");if(!n)continue;let s=Ss(n),o=Ss(i);t.push([s,o])}return new c(z.fromArray(t))}catch{return new f(St)}}function Vn(e){if(typeof e=="string")return"String";if(typeof e=="boolean")return"Bool";if(e instanceof He)return"Result";if(e instanceof z)return"List";if(e instanceof nr)return"BitArray";if(e instanceof Fe)return"Dict";if(Number.isInteger(e))return"Int";if(Array.isArray(e))return`Tuple of ${e.length} elements`;if(typeof e=="number")return"Float";if(e===null)return"Null";if(e===void 0)return"Nil";{let t=typeof e;return t.charAt(0).toUpperCase()+t.slice(1)}}function Ct(e,t){return au(e,Vn(t))}function au(e,t){return new f(z.fromArray([new W(e,t,z.fromArray([]))]))}function gs(e){return typeof e=="string"?new c(e):Ct("String",e)}function ys(e){return Number.isInteger(e)?new c(e):Ct("Int",e)}function bs(e){return Array.isArray(e)?new c(e):Ct("Tuple",e)}function Hn(e,t){return t>=0&&e.length>t?new c(e[t]):new f(St)}function ks(e){return Array.isArray(e)?new c(z.fromArray(e)):e instanceof z?new c(e):Ct("List",e)}function As(e,t){if(e==null||e instanceof _)return new c(new _);e instanceof $&&(e=e[0]);let r=t(e);return r.isOk()?new c(new $(r[0])):r}function Ls(e,t){let r=()=>Ct("Dict",e);if(e instanceof Fe||e instanceof WeakMap||e instanceof Map){let n=Ns(e,t);return new c(n.isOk()?new $(n[0]):new _)}else return e===null?r():Object.getPrototypeOf(e)==Object.prototype?Cs(e,t,()=>new c(new _)):Cs(e,t,r)}function Cs(e,t,r){try{return t in e?new c(new $(e[t])):r()}catch{return r()}}function ue(){return zs()}function Ke(e,t,r){return Ps(t,r,e)}function cu(e,t){for(;;){let r=e,n=t;if(r.hasLength(0))return n;{let i=r.head;e=r.tail,t=m(i,n)}}}function fu(e,t){for(;;){let r=e,n=t;if(r.hasLength(0))return cu(n,u([]));{let i=r.head;e=r.tail,t=m(i[0],n)}}}function du(e){let t=mr(e);return fu(t,u([]))}function xr(e){return du(e)}function Gs(e){return e[1]}function $u(e,t){for(;;){let r=e,n=t;if(r.atLeastLength(1))e=r.tail,t=n+1;else return n}}function ci(e){return $u(e,0)}function mu(e,t){for(;;){let r=e,n=t;if(r.hasLength(0))return n;{let i=r.head;e=r.tail,t=m(i,n)}}}function I(e){return mu(e,u([]))}function qt(e){if(e.hasLength(0))return new f(void 0);{let t=e.head;return new c(t)}}function hu(e,t,r){for(;;){let n=e,i=t,s=r;if(n.hasLength(0))return I(s);{let o=n.head;e=n.tail,t=i,r=m(i(o),s)}}}function E(e,t){return hu(e,t,u([]))}function wu(e,t,r,n){for(;;){let i=e,s=t,o=r,l=n;if(i.hasLength(0))return I(l);{let a=i.head,d=i.tail,h=m(s(a,o),l);e=d,t=s,r=o+1,n=h}}}function yr(e,t){return wu(e,t,0,u([]))}function xu(e,t,r){for(;;){let n=e,i=t,s=r;if(n.hasLength(0))return new c(I(s));{let o=n.head,l=n.tail,a=i(o);if(a.isOk()){let d=a[0];e=l,t=i,r=m(d,s)}else{let d=a[0];return new f(d)}}}}function gt(e,t){return xu(e,t,u([]))}function Ot(e,t){for(;;){let r=e,n=t;if(n<=0)return r;if(r.hasLength(0))return u([]);e=r.tail,t=n-1}}function gu(e,t,r){for(;;){let n=e,i=t,s=r;if(i<=0)return I(s);if(n.hasLength(0))return I(s);{let l=n.head;e=n.tail,t=i-1,r=m(l,s)}}}function Bn(e,t){return gu(e,t,u([]))}function yu(e,t){for(;;){let r=e,n=t;if(r.hasLength(0))return n;{let i=r.head;e=r.tail,t=m(i,n)}}}function me(e,t){return yu(I(e),t)}function bu(e,t){for(;;){let r=e,n=t;if(r.hasLength(0))return n;{let i=r.head;e=r.tail,t=m(i,n)}}}function ku(e,t){for(;;){let r=e,n=t;if(r.hasLength(0))return I(n);{let i=r.head;e=r.tail,t=bu(i,n)}}}function Yn(e){return ku(e,u([]))}function Ie(e,t,r){for(;;){let n=e,i=t,s=r;if(n.hasLength(0))return i;{let o=n.head;e=n.tail,t=s(i,o),r=s}}}function Au(e,t,r,n){for(;;){let i=e,s=t,o=r,l=n;if(i.hasLength(0))return s;{let a=i.head;e=i.tail,t=o(s,a,l),r=o,n=l+1}}}function fi(e,t,r){return Au(e,t,r,0)}function Lu(e,t){for(;;){let r=e,n=t;if(r.hasLength(0))return new f(void 0);{let i=r.head,s=r.tail,o=n(i);if(o.isOk()){let l=o[0];return new c(l)}else e=s,t=n}}}function vu(e,t,r){for(;;){let n=e,i=t,s=r;if(n.hasLength(0))return I(s);{let o=n.head;e=n.tail,t=i,r=m(o,m(i,s))}}}function fr(e,t){if(e.hasLength(0))return e;if(e.hasLength(1))return e;{let r=e.head,n=e.tail;return vu(n,t,u([r]))}}function Ou(e,t,r){for(;;){let n=e,i=t,s=r;if(i<=0)return s;e=n,t=i-1,r=m(n,s)}}function Ds(e,t){return Ou(e,t,u([]))}function he(e,t){return Lu(e,r=>{let n=r[0],i=r[1];return b(n,t)?new c(i):new f(void 0)})}function br(e,t,r){if(e.hasLength(0))return u([[t,r]]);if(e.atLeastLength(1)&&b(e.head[0],t)){let n=e.head[0],i=e.tail;return m([t,r],i)}else{let n=e.head,i=e.tail;return m(n,br(i,t,r))}}var Mt=class extends p{constructor(t,r,n,i,s,o,l){super(),this.scheme=t,this.userinfo=r,this.host=n,this.port=i,this.path=s,this.query=o,this.fragment=l}};function Bs(e,t){let n=es(e,new or(!0,!1)),i=os(n),s=S(i,a=>lr(a,t)),o=N(s,qt),l=S(o,a=>a.submatches);return Je(l,u([]))}function ju(e){if(e instanceof _)return new _;{let t=e[0],r=vt(t);if(r.isOk()&&r[0][0]==="?"){let n=r[0][1];return new $(n)}else return new _}}function kr(e){return e instanceof $&&e[0]===""?new _:e instanceof _?new _:e}function Eu(e,t){for(;;){let r=e,n=t;if(n===0)return 0;if(r.hasLength(0))return n;e=r.tail,t=n-1}}function Rs(e,t){return me(e,Ds(new _,Eu(e,t)))}function Tu(e){let t=ve(e,"");if(t==="")return[new _,new _,new _];if(t==="//")return[new _,new $(""),new _];{let r=t,n=(()=>{let s=Bs("^(//)?((.*)@)?(\\[[a-zA-Z0-9:.]*\\]|[^:]*)(:(\\d*))?",r);return Rs(s,6)})();if(n.hasLength(6)){let i=n.tail.tail.head,s=n.tail.tail.tail.head,o=n.tail.tail.tail.tail.tail.head,l=kr(i),a=kr(s),d=(()=>{let w=ve(o,""),g=Oe(w);return ht(g)})();return[l,a,d]}else return[new _,new _,new _]}}function Su(e){let t="^(([a-z][a-z0-9\\+\\-\\.]*):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#.*)?",r=(()=>{let y=Bs(t,e);return Rs(y,8)})(),n=(()=>{if(r.hasLength(8)){let x=r.tail.head,y=r.tail.tail.head,T=r.tail.tail.tail.tail.head,F=r.tail.tail.tail.tail.tail.head,_e=r.tail.tail.tail.tail.tail.tail.tail.head;return[x,y,T,F,_e]}else return[new _,new _,new _,new _,new _]})(),i=n[0],s=n[1],o=n[2],l=n[3],a=n[4],d=kr(i),h=ve(o,""),w=ju(l),g=Tu(s),L=g[0],K=g[1],ke=g[2],Ae=(()=>{let y=Ue(a,void 0),T=N(y,vt),F=S(T,Gs);return ht(F)})(),de=(()=>{let y=kr(d);return ir(y,Ce)})();return new c(new Mt(de,L,K,ke,h,w,Ae))}function Ar(e){return Su(e)}function di(e){return Is(e)}function _i(e){return Fs(e)}function Hs(e){let t=(()=>{let l=e.fragment;if(l instanceof $){let a=l[0];return u(["#",a])}else return u([])})(),r=(()=>{let l=e.query;if(l instanceof $){let a=l[0];return m("?",m(a,t))}else return t})(),n=m(e.path,r),i=(()=>{let l=e.host,a=At(e.path,"/");if(l instanceof $&&!a&&l[0]!==""){let d=l[0];return m("/",n)}else return n})(),s=(()=>{let l=e.host,a=e.port;if(l instanceof $&&a instanceof $){let d=a[0];return m(":",m(j(d),i))}else return i})(),o=(()=>{let l=e.scheme,a=e.userinfo,d=e.host;if(l instanceof $&&a instanceof $&&d instanceof $){let h=l[0],w=a[0],g=d[0];return m(h,m("://",m(w,m("@",m(g,s)))))}else if(l instanceof $&&a instanceof _&&d instanceof $){let h=l[0],w=d[0];return m(h,m("://",m(w,s)))}else if(l instanceof $&&a instanceof $&&d instanceof _){let h=l[0];return m(h,m(":",s))}else if(l instanceof $&&a instanceof _&&d instanceof _){let h=l[0];return m(h,m(":",s))}else if(l instanceof _&&a instanceof _&&d instanceof $){let h=d[0];return m("//",m(h,s))}else return s})();return Lt(o)}function we(e,t,r){return e?t:r()}function mi(e){return JSON.stringify(e)}function Us(e){return Object.fromEntries(e)}function Ws(e){return e.toArray()}function Js(){return null}function Ks(e){try{let t=JSON.parse(e);return new c(t)}catch(t){return new f(qu(t,e))}}function qu(e,t){return Mu(e)?new vr:zu(e,t)}function Mu(e){return/((unexpected (end|eof))|(end of data)|(unterminated string)|(json( parse error|\.parse)\: expected '(\:|\}|\])'))/i.test(e.message)}function zu(e,t){let r=[Nu,Pu,Iu,Fu];for(let n of r){let i=n(e,t);if(i)return i}return new qe("",0)}function Nu(e){let r=/unexpected token '(.)', ".+" is not valid JSON/i.exec(e.message);if(!r)return null;let n=Lr(r[1]);return new qe(n,-1)}function Pu(e){let r=/unexpected token (.) in JSON at position (\d+)/i.exec(e.message);if(!r)return null;let n=Lr(r[1]),i=Number(r[2]);return new qe(n,i)}function Fu(e,t){let n=/(unexpected character|expected .*) at line (\d+) column (\d+)/i.exec(e.message);if(!n)return null;let i=Number(n[2]),s=Number(n[3]),o=Gu(i,s,t),l=Lr(t[o]);return new qe(l,o)}function Iu(e){let r=/unexpected (identifier|token) "(.)"/i.exec(e.message);if(!r)return null;let n=Lr(r[2]);return new qe(n,0)}function Lr(e){return"0x"+e.charCodeAt(0).toString(16).toUpperCase()}function Gu(e,t,r){if(e===1)return t-1;let n=1,i=0;return r.split("").find((s,o)=>(s===`
`&&(n+=1),n===e?(i=o+t,!0):!1)),i}var vr=class extends p{},qe=class extends p{constructor(t,r){super(),this.byte=t,this.position=r}};var Or=class extends p{constructor(t){super(),this[0]=t}};function Bu(e,t){return C(Ks(e),r=>{let n=t(r);return le(n,i=>new Or(i))})}function jr(e,t){return Bu(e,t)}function Vs(e){return mi(e)}function P(e){return e}function Ru(){return Js()}function Ys(e,t){if(e instanceof $){let r=e[0];return t(r)}else return Ru()}function Me(e){return Us(e)}function wi(e){return Ws(e)}function xe(e,t){let n=E(e,t);return wi(n)}var Er=class extends p{constructor(t){super(),this.all=t}};function Hu(e){return new Er(u([t=>e(t.dispatch,t.emit,t.select)]))}function te(e){return Hu((t,r,n)=>e(t))}function Tr(){return new Er(u([]))}var Ye=class extends p{constructor(t){super(),this.content=t}},v=class extends p{constructor(t,r,n,i,s,o,l){super(),this.key=t,this.namespace=r,this.tag=n,this.attrs=i,this.children=s,this.self_closing=o,this.void=l}},De=class extends p{constructor(t){super(),this.subtree=t}},Ze=class extends p{constructor(t,r){super(),this.elements=t,this.key=r}},Xe=class extends p{constructor(t,r,n){super(),this[0]=t,this[1]=r,this.as_property=n}},Nt=class extends p{constructor(t,r){super(),this[0]=t,this[1]=r}};function Ku(e){if(e instanceof Xe)return new f(void 0);{let t=e[0],r=e[1],n=dr(t,2);return new c([n,r])}}function Zs(e,t,r){return fi(e,t,(n,i,s)=>{let o=r+"-"+j(s);return Xs(i,n,o)})}function Xs(e,t,r){for(;;){let n=e,i=t,s=r;if(n instanceof Ye)return i;if(n instanceof De){let o=n.subtree;e=o(),t=i,r=s}else if(n instanceof v){let o=n.attrs,l=n.children,a=Ie(o,i,(d,h)=>{let w=Ku(h);if(w.isOk()){let g=w[0][0],L=w[0][1];return Ke(d,s+"-"+g,L)}else return d});return Zs(l,a,s)}else{let o=n.elements;return Zs(o,i,s)}}}function Qs(e){return Xs(e,ue(),"0")}function Sr(e,t){return new Xe(e,t,!1)}function to(e,t){return new Nt("on"+e,t)}function k(e){return Sr("class",e)}function Cr(e){return Sr("id",e)}function ro(e){return Sr("href",e)}function Qe(e){return Sr("src",e)}function R(e,t,r){return e==="area"?new v("","",e,t,u([]),!1,!0):e==="base"?new v("","",e,t,u([]),!1,!0):e==="br"?new v("","",e,t,u([]),!1,!0):e==="col"?new v("","",e,t,u([]),!1,!0):e==="embed"?new v("","",e,t,u([]),!1,!0):e==="hr"?new v("","",e,t,u([]),!1,!0):e==="img"?new v("","",e,t,u([]),!1,!0):e==="input"?new v("","",e,t,u([]),!1,!0):e==="link"?new v("","",e,t,u([]),!1,!0):e==="meta"?new v("","",e,t,u([]),!1,!0):e==="param"?new v("","",e,t,u([]),!1,!0):e==="source"?new v("","",e,t,u([]),!1,!0):e==="track"?new v("","",e,t,u([]),!1,!0):e==="wbr"?new v("","",e,t,u([]),!1,!0):new v("","",e,t,r,!1,!1)}function qr(e,t){if(e instanceof v){let r=e.namespace,n=e.tag,i=e.attrs,s=e.children,o=e.self_closing,l=e.void;return new v(t,r,n,i,s,o,l)}else if(e instanceof De){let r=e.subtree;return new De(()=>qr(r(),t))}else if(e instanceof Ze){let n=e.elements,i=yr(n,(s,o)=>{if(s instanceof v){let l=s.key,a=l===""?t+"-"+j(o):t+"-"+l;return qr(s,a)}else return qr(s,t)});return new Ze(i,t)}else return e}function Mr(e,t){return e(E(t,r=>{let n=r[0],i=r[1];return qr(i,n)}))}function no(e){return new Ye(e)}var gi=class extends p{constructor(t){super(),this.dict=t}};function io(){return new gi(ue())}var zr=class extends p{constructor(t){super(),this[0]=t}},Nr=class extends p{constructor(t,r){super(),this[0]=t,this[1]=r}},Pr=class extends p{constructor(t,r){super(),this[0]=t,this[1]=r}};function oo(e){return b(e.created,ue())&&b(e.removed,io())&&b(e.updated,ue())}var Fr=class extends p{constructor(t){super(),this[0]=t}},Ir=class extends p{constructor(t,r){super(),this[0]=t,this[1]=r}},Pt=class extends p{constructor(t){super(),this[0]=t}},fe=class extends p{constructor(t){super(),this[0]=t}},Ft=class extends p{constructor(t,r){super(),this[0]=t,this[1]=r}},Gr=class extends p{constructor(t,r){super(),this[0]=t,this[1]=r}};var It=class extends p{},Dr=class extends p{constructor(t,r){super(),this[0]=t,this[1]=r}},Br=class extends p{constructor(t){super(),this[0]=t}},Rr=class extends p{constructor(t){super(),this[0]=t}};function yi(e,t,r){let n,i=[{prev:e,next:t,parent:e.parentNode}];for(;i.length;){let{prev:s,next:o,parent:l}=i.pop();for(;o.subtree!==void 0;)o=o.subtree();if(o.content!==void 0)if(s)if(s.nodeType===Node.TEXT_NODE)s.textContent!==o.content&&(s.textContent=o.content),n??=s;else{let a=document.createTextNode(o.content);l.replaceChild(a,s),n??=a}else{let a=document.createTextNode(o.content);l.appendChild(a),n??=a}else if(o.tag!==void 0){let a=ta({prev:s,next:o,dispatch:r,stack:i});s?s!==a&&l.replaceChild(a,s):l.appendChild(a),n??=a}else if(o.elements!==void 0)for(let a of Hr(o))i.unshift({prev:s,next:a,parent:l}),s=s?.nextSibling}return n}function ta({prev:e,next:t,dispatch:r,stack:n}){let i=t.namespace||"http://www.w3.org/1999/xhtml",s=e&&e.nodeType===Node.ELEMENT_NODE&&e.localName===t.tag&&e.namespaceURI===(t.namespace||"http://www.w3.org/1999/xhtml"),o=s?e:i?document.createElementNS(i,t.tag):document.createElement(t.tag),l;if(Gt.has(o))l=Gt.get(o);else{let x=new Map;Gt.set(o,x),l=x}let a=s?new Set(l.keys()):null,d=s?new Set(Array.from(e.attributes,x=>x.name)):null,h=null,w=null,g=null;if(s&&t.tag==="textarea"){let x=t.children[Symbol.iterator]().next().value?.content;x!==void 0&&(o.value=x)}for(let x of t.attrs){let y=x[0],T=x[1];if(x.as_property)o[y]!==T&&(o[y]=T),s&&d.delete(y);else if(y.startsWith("on")){let F=y.slice(2),_e=r(T,F==="input");l.has(F)||o.addEventListener(F,Dt),l.set(F,_e),s&&a.delete(F)}else if(y.startsWith("data-lustre-on-")){let F=y.slice(15),_e=r(ra);l.has(F)||o.addEventListener(F,Dt),l.set(F,_e),o.setAttribute(y,T)}else y==="class"?h=h===null?T:h+" "+T:y==="style"?w=w===null?T:w+T:y==="dangerous-unescaped-html"?g=T:(o.getAttribute(y)!==T&&o.setAttribute(y,T),(y==="value"||y==="selected")&&(o[y]=T),s&&d.delete(y))}if(h!==null&&(o.setAttribute("class",h),s&&d.delete("class")),w!==null&&(o.setAttribute("style",w),s&&d.delete("style")),s){for(let x of d)o.removeAttribute(x);for(let x of a)l.delete(x),o.removeEventListener(x,Dt)}if(t.key!==void 0&&t.key!=="")o.setAttribute("data-lustre-key",t.key);else if(g!==null)return o.innerHTML=g,o;let L=o.firstChild,K=null,ke=null,Ae=null,de=Bt(t).next().value;if(s&&de!==void 0&&de.key!==void 0&&de.key!==""){K=new Set,ke=lo(e),Ae=lo(t);for(let x of Bt(t))L=na(L,x,o,n,Ae,ke,K)}else for(let x of Bt(t))n.unshift({prev:L,next:x,parent:o}),L=L?.nextSibling;for(;L;){let x=L.nextSibling;o.removeChild(L),L=x}return o}var Gt=new WeakMap;function Dt(e){let t=e.currentTarget;if(!Gt.has(t)){t.removeEventListener(e.type,Dt);return}let r=Gt.get(t);if(!r.has(e.type)){t.removeEventListener(e.type,Dt);return}r.get(e.type)(e)}function ra(e){let t=e.currentTarget,r=t.getAttribute(`data-lustre-on-${e.type}`),n=JSON.parse(t.getAttribute("data-lustre-data")||"{}"),i=JSON.parse(t.getAttribute("data-lustre-include")||"[]");switch(e.type){case"input":case"change":i.push("target.value");break}return{tag:r,data:i.reduce((s,o)=>{let l=o.split(".");for(let a=0,d=s,h=e;a<l.length;a++)a===l.length-1?d[l[a]]=h[l[a]]:(d[l[a]]??={},h=h[l[a]],d=d[l[a]]);return s},{data:n})}}function lo(e){let t=new Map;if(e)for(let r of Bt(e)){let n=r?.key||r?.getAttribute?.("data-lustre-key");n&&t.set(n,r)}return t}function na(e,t,r,n,i,s,o){for(;e&&!i.has(e.getAttribute("data-lustre-key"));){let a=e.nextSibling;r.removeChild(e),e=a}if(s.size===0){for(let a of Bt(t))n.unshift({prev:e,next:a,parent:r}),e=e?.nextSibling;return e}if(o.has(t.key))return console.warn(`Duplicate key found in Lustre vnode: ${t.key}`),n.unshift({prev:null,next:t,parent:r}),e;o.add(t.key);let l=s.get(t.key);if(!l&&!e)return n.unshift({prev:null,next:t,parent:r}),e;if(!l&&e!==null){let a=document.createTextNode("");return r.insertBefore(a,e),n.unshift({prev:a,next:t,parent:r}),e}return!l||l===e?(n.unshift({prev:e,next:t,parent:r}),e=e?.nextSibling,e):(r.insertBefore(l,e),n.unshift({prev:l,next:t,parent:r}),e)}function*Bt(e){for(let t of e.children)yield*Hr(t)}function*Hr(e){if(e.elements!==void 0)for(let t of e.elements)yield*Hr(t);else e.subtree!==void 0?yield*Hr(e.subtree()):yield e}var bi=class e{static start({init:t,update:r,view:n},i,s){if(!Ai())return new f(new Rt);let o=i instanceof HTMLElement?i:document.querySelector(i);if(!o)return new f(new Ur(i));let l=new e(o,t(s),r,n);return new c(a=>l.send(a))}constructor(t,[r,n],i,s){this.root=t,this.#e=r,this.#s=i,this.#r=s,this.#t=window.requestAnimationFrame(()=>this.#n(n.all.toArray(),!0))}root;send(t){if(t instanceof Pt){if(t[0]instanceof Rr){this.#t=window.cancelAnimationFrame(this.#t),this.#i=[],this.#e=t[0][0];let r=this.#r(this.#e),n=(s,o=!1)=>l=>{let a=s(l);a instanceof c&&this.send(new fe(a[0],o))},i=this.root.firstChild??this.root.appendChild(document.createTextNode(""));yi(i,r,n)}}else if(t instanceof fe){let r=t[0],n=t[1]??!1;this.#i.push(r),n?(this.#t=window.cancelAnimationFrame(this.#t),this.#n()):this.#t||(this.#t=window.requestAnimationFrame(()=>this.#n()))}else if(t instanceof Ft){let r=t[0],n=t[1];this.root.dispatchEvent(new CustomEvent(r,{detail:n,bubbles:!0,composed:!0}))}else if(t instanceof It)for(this.#t=window.cancelAnimationFrame(this.#t),this.#e=null,this.#s=null,this.#r=null,this.#i=null;this.root.firstChild;)this.root.firstChild.remove()}#e;#s;#r;#i=[];#t;#n(t=[],r=!1){if(this.#t=void 0,!this.#o(t,r))return;let n=this.#r(this.#e),i=(o,l=!1)=>a=>{let d=o(a);d instanceof c&&this.send(new fe(d[0],l))},s=this.root.firstChild??this.root.appendChild(document.createTextNode(""));yi(s,n,i)}#o(t=[],r=!1){for(;this.#i.length>0;){let n=this.#i.shift(),[i,s]=this.#s(this.#e,n);r||=this.#e!==i,t=t.concat(s.all.toArray()),this.#e=i}for(;t.length>0;)t.shift()({dispatch:l=>this.send(new fe(l)),emit:(l,a)=>this.root.dispatchEvent(new CustomEvent(l,{detail:a,bubbles:!0,composed:!0})),select:()=>{}});return this.#i.length>0?this.#o(t,r):r}},uo=bi.start;var ki=class e{static start({init:t,update:r,view:n,on_attribute_change:i},s){let o=new e(t(s),r,n,i);return new c(l=>o.send(l))}constructor([t,r],n,i,s){this.#e=t,this.#s=n,this.#i=i,this.#t=i(t),this.#u=s,this.#n=new Map,this.#o=Qs(this.#t),this.#l(r.all.toArray())}send(t){if(t instanceof Fr){for(let r of t[0]){let n=this.#u.get(r[0]);if(!n)continue;let i=n(r[1]);i instanceof f||this.#r.push(i)}this.#l()}else if(t instanceof Ir)this.#r=this.#r.concat(t[0].toArray()),this.#l(t[1].all.toArray());else if(!(t instanceof Pt))if(t instanceof fe)this.#r.push(t[0]),this.#l();else if(t instanceof Ft){let r=new Nr(t[0],t[1]);for(let[n,i]of this.#n)i(r)}else if(t instanceof Gr){let r=this.#o.get(t[0]);if(!r)return;let n=r(t[1]);if(n instanceof f)return;this.#r.push(n[0]),this.#l()}else if(t instanceof Dr){let r=xr(this.#u),n=new Pr(r,this.#t);this.#n=this.#n.set(t[0],t[1]),t[1](n)}else t instanceof Br&&(this.#n=this.#n.delete(t[0]))}#e;#s;#r;#i;#t;#n;#o;#u;#l(t=[]){if(!this.#a(!1,t))return;let r=this.#i(this.#e),n=elements(this.#t,r);if(!oo(n)){let i=new zr(n);for(let[s,o]of this.#n)o(i)}this.#t=r,this.#o=n.handlers}#a(t=!1,r=[]){for(;this.#r.length>0;){let n=this.#r.shift(),[i,s]=this.#s(this.#e,n);t||=this.#e!==i,r=r.concat(s.all.toArray()),this.#e=i}for(;r.length>0;)r.shift()({dispatch:l=>this.send(new fe(l)),emit:(l,a)=>this.root.dispatchEvent(new CustomEvent(l,{detail:a,bubbles:!0,composed:!0})),select:()=>{}});return this.#r.length>0?this.#a(t,r):t}},ia=ki.start,Ai=()=>globalThis.window&&window.document;var Li=class extends p{constructor(t,r,n,i){super(),this.init=t,this.update=r,this.view=n,this.on_attribute_change=i}};var Ur=class extends p{constructor(t){super(),this.selector=t}},Rt=class extends p{};function ao(e,t,r){return new Li(e,t,r,new _)}function po(e,t,r){return we(!Ai(),new f(new Rt),()=>uo(e,t,r))}var et=class e{constructor(t){this.promise=t}static wrap(t){return t instanceof Promise?new e(t):t}static unwrap(t){return t instanceof e?t.promise:t}};function Wr(e){return Promise.resolve(et.wrap(e))}function co(e,t){return e.then(r=>t(et.unwrap(r)))}function Jr(e,t){return e.then(r=>et.wrap(t(et.unwrap(r))))}function vi(e,t){return e.catch(r=>t(r))}function fo(e,t){return Jr(e,n=>(t(n),n))}function Kr(e,t){return co(e,n=>{if(n.isOk()){let i=n[0];return t(i)}else{let i=n[0];return Wr(new f(i))}})}function Oi(e){return new Audio(e)}async function ji(e){try{return await e.play(),new c}catch(t){return new f(t.toString())}}function Ei(e){let t=document.getElementById(e);return t?new c(t):new f}function Ti(e,t,r){e.setAttribute(t,r)}function pa(){return globalThis}function ca(e){window.alert(e)}function fa(e,t){return window.addEventListener(e,t)}async function da(){try{return new c(await window.navigator.wakeLock.request("screen"))}catch(e){return new f(e.toString())}}function Si(){return window.location.href}function _a(e){try{return new c(e.location.href)}catch(t){return new f(t.toString())}}function $a(e,t){e.location.href=t}function ma(){return window.location.reload()}function ha(e){return e.location.reload()}function wa(e){return e.focus()}function xa(){let e=window.location.hash;return e==""?new f:new c(decodeURIComponent(e.slice(1)))}function ga(){let e=window.location.search;return e==""?new f:new c(decodeURIComponent(e.slice(1)))}function ya(e){return e.innerHeight}function ba(e){return e.innerWidth}function ka(e){return e.outerHeight}function Aa(e){return e.outerWidth}function La(e){return e.screenX}function va(e){return e.screenY}function Oa(e){return e.screenTop}function ja(e){return e.screenLeft}function Ea(e){return e.scrollX}function Ta(e){return e.scrollY}function Sa(e,t,r){try{return new c(window.open(e,t,r))}catch(n){return new f(n.toString())}}function Ca(e){e.close()}function qa(e){return e.closed}function Ma(e){return window.queueMicrotask(e)}function za(e){return window.requestAnimationFrame(e)}function Na(e){return window.cancelAnimationFrame(e)}function Pa(string){try{return new c(eval(string))}catch(e){return new f(e.toString())}}async function Fa(e){try{return new c(await import(e))}catch(t){return new f(t.toString())}}function Ci(e){console.warn(e)}function Vr(e){console.error(e)}function H(e){return no(e)}function mo(e,t){return R("aside",e,t)}function Yr(e,t){return R("h1",e,t)}function ho(e,t){return R("h3",e,t)}function U(e,t){return R("div",e,t)}function Zr(e,t){return R("li",e,t)}function Xr(e,t){return R("ul",e,t)}function wo(e,t){return R("a",e,t)}function Qr(e,t){return R("span",e,t)}function nt(e){return R("img",e,u([]))}function en(e,t){return R("button",e,t)}function xo(e){return R("input",e,u([]))}function go(e,t){return R("dialog",e,t)}var re=class extends p{},it=class extends p{},tn=class extends p{},rn=class extends p{},Ut=class extends p{},nn=class extends p{},sn=class extends p{},on=class extends p{},ln=class extends p{};var ye=class extends p{},Re=class extends p{};function yo(e){return e instanceof sn?"connect":e instanceof Ut?"delete":e instanceof re?"get":e instanceof tn?"head":e instanceof on?"options":e instanceof ln?"patch":e instanceof it?"post":e instanceof rn?"put":e instanceof nn?"trace":e[0]}function bo(e){return e instanceof ye?"http":"https"}var un=class extends p{constructor(t,r,n,i,s,o,l,a){super(),this.method=t,this.headers=r,this.body=n,this.scheme=i,this.host=s,this.port=o,this.path=l,this.query=a}};function Oo(e){return new Mt(new $(bo(e.scheme)),new _,new $(e.host),e.port,e.path,e.query,new _)}function qi(e,t,r){let n=br(e.headers,Ce(t),r);return e.withFields({headers:n})}function an(e,t){let r=e.method,n=e.headers,i=e.scheme,s=e.host,o=e.port,l=e.path,a=e.query;return new un(r,n,t,i,s,o,l,a)}function jo(e,t){let r=i=>Te(u([_i(i[0]),"=",_i(i[1])])),n=(()=>{let s=E(t,r),o=fr(s,yt("&")),l=In(o),a=Y(l);return new $(a)})();return e.withFields({query:n})}function Mi(e,t){return e.withFields({method:t})}function Eo(){return new un(new re,u([]),"",new Re,"localhost",new _,"",new _)}function To(e,t){return e.withFields({scheme:t})}function So(e,t){return e.withFields({host:t})}function Co(e,t){return e.withFields({port:new $(t)})}function qo(e,t){return e.withFields({path:t})}var be=class extends p{constructor(t,r,n){super(),this.status=t,this.headers=r,this.body=n}};async function zo(e){try{return new c(await fetch(e))}catch(t){return new f(new pn(t.toString()))}}function No(e){return new be(e.status,z.fromArray([...e.headers]),e)}function Po(e){let t=Hs(Oo(e)),r=yo(e.method).toUpperCase(),n={headers:Ha(e.headers),method:r};return r!=="GET"&&r!=="HEAD"&&(n.body=e.body),new globalThis.Request(t,n)}function Ha(e){let t=new globalThis.Headers;for(let[r,n]of e)t.append(r.toLowerCase(),n);return t}async function zi(e){let t;try{t=await e.body.text()}catch{return new f(new cn)}return new c(e.withFields({body:t}))}var pn=class extends p{constructor(t){super(),this[0]=t}},cn=class extends p{};function Fo(e){let r=Po(e),n=zo(r);return Kr(n,i=>Wr(new c(No(i))))}var Ni=class extends p{constructor(t){super(),this[0]=t}},fn=class extends p{constructor(t){super(),this[0]=t}},dn=class extends p{},Pi=class extends p{},Wt=class extends p{constructor(t,r){super(),this[0]=t,this[1]=r}},Fi=class extends p{},Ii=class extends p{constructor(t){super(),this.run=t}};function Wa(e,t,r){let n=Fo(e),i=Kr(n,zi),s=Jr(i,l=>{if(l.isOk()){let a=l[0];return t.run(new c(a))}else return t.run(new f(new dn))}),o=vi(s,l=>t.run(new f(new dn)));fo(o,r)}function Io(e,t){return te(r=>Wa(e,t,r))}function Ja(e){if(e instanceof be&&200<=e.status&&e.status<=299){let t=e.status,r=e.body;return new c(r)}else{if(e instanceof be&&e.status===401)return new f(new Fi);if(e instanceof be&&e.status===404)return new f(new Pi);if(e instanceof be&&e.status===500){let t=e.body;return new f(new Ni(t))}else{let t=e.status,r=e.body;return new f(new Wt(t,r))}}}function Go(e){return new Ii(t=>{let n=C(t,Ja);return e(n)})}var Gi=class extends p{constructor(t,r,n,i,s,o,l){super(),this.id=t,this.title=r,this.artists=n,this.album=i,this.album_cover=s,this.source=o,this.preview_url=l}},_n=class extends p{constructor(t){super(),this.url=t}},Di=class extends p{constructor(t){super(),this.url=t}};function Va(e){if(e instanceof _n){let t=e.url;return Me(u([["source",P("youtube")],["url",P(t)]]))}else{let t=e.url;return Me(u([["source",P("spotify")],["url",P(t)]]))}}function $n(e){return Me(u([["id",P(e.id)],["title",P(e.title)],["artists",(()=>{let t=e.artists;return xe(t,P)})()],["album",P(e.album)],["album_cover",P(e.album_cover)],["source",Va(e.source)],["preview_url",Ys(e.preview_url,P)]]))}function Ya(e){let t=(()=>{let r=e;return M("source",q)(r)})();if(t.isOk()&&t[0]==="youtube"){let r=e,n=M("url",q)(r);return S(n,i=>new _n(i))}else if(t.isOk()&&t[0]==="spotify"){let r=e,n=M("url",q)(r);return S(n,i=>new Di(i))}else if(t.isOk()){let r=t[0];return new f(u([new W("Wrong source name",r,u(["source"]))]))}else{let r=t[0];return new f(r)}}function mn(e){let t=e;return xs((r,n,i,s,o,l,a)=>new Gi(r,n,i,s,o,l,a),M("id",q),M("title",q),M("artists",ae(q)),M("album",q),M("album_cover",q),M("source",Ya),M("preview_url",hs(q)))(t)}var Bi=class extends p{constructor(t,r,n){super(),this.id=t,this.name=r,this.songs=n}},Ri=class extends p{constructor(t){super(),this.name=t}};function Bo(e){return Me(u([["id",P(e.id)],["name",P(e.name)],["songs",xe(e.songs,$n)]]))}function Ro(e){let t=e;return Kn((r,n,i)=>new Bi(r,n,i),M("id",q),M("name",q),M("songs",ae(mn)))(t)}function Ho(e){return Me(u([["name",P(e.name)]]))}function Uo(e){let t=e;return Un(r=>new Ri(r),M("name",q))(t)}var st=class extends p{constructor(t){super(),this.search=t}},ot=class extends p{constructor(t){super(),this.results=t}},lt=class extends p{constructor(t){super(),this.error=t}},Ne=class extends p{constructor(t){super(),this.message=t}},ut=class extends p{constructor(t){super(),this.preview_url=t}},at=class extends p{constructor(t){super(),this.playlists=t}},pt=class extends p{constructor(t){super(),this.id=t}};function Wo(){return u([ho(u([k("text-lg mb-4 text-center")]),u([H("Search songs and create playlists that can be exported to Spotify, Youtube Music,...")])),wo(u([ro("/login"),k("text-green-400 bg-zinc-700 hover:bg-zinc-600 rounded-md font-bold flex gap-2 py-2 px-4")]),u([nt(u([Qe("https://storage.googleapis.com/pr-newsroom-wp/1/2023/05/Spotify_Primary_Logo_RGB_Green.png"),k("h-6")])),H("Login to Spotify")]))])}function Jo(e,t){return U(u([k("bg-zinc-800 min-w-screen min-h-screen text-pink-100 p-4 flex flex-nowrap items-stretch")]),u([mo(u([k("w-1/8 md:w-1/6 lg:w-1/4 max-w-lg bg-zinc-900 rounded-lg")]),t),U(u([k("w-3/4 md:w-2/3 lg:w-1/2 max-w-3xl flex-1 flex flex-col items-center py-8")]),m(Yr(u([k("text-4xl font-bold mb-8")]),u([H("Playlist Maker")])),e))]))}function Jt(e,t){return to(e,t)}function Vo(e){return u([U(u([k("p-2 flex flex-col items-stretch")]),u([Mr(t=>Xr(u([k("flex flex-col items-stretch")]),t),E(e,r=>[r[0],Zr(u([]),u([H(r[1].name)]))])),en(u([k("text-center font-bold border border-zinc-100"),Jt("click",t=>new c(new pt("create-playlist")))]),u([H("+ Create playlist")]))])),go(u([Cr("create-playlist")]),u([Yr(u([]),u([H("Create a new playlist")]))]))])}function _p(e,t){return r=>N(ae(_r)(r),n=>{if(e>=0){let o=Ot(n,e),l=qt(o),a=Nn(l,u([new W("A list with at least"+j(e+1)+"elements","A list with"+j(ci(n))+"elements",u([j(e)]))]));return C(a,t)}else return new f(u([new W("An 'index' decoder with a non-negative index",j(e),u([]))]))})}function $p(e,t){return $r(u([ws(e,t),M(j(e),t),_p(e,t)]))}function Hi(e,t,r){if(e.hasLength(0))return t(r);{let n=e.head,i=e.tail,s=Oe(n);if(s.isOk()){let o=s[0],l=r,a=$p(o,_r)(l);return C(a,d=>Hi(i,t,d))}else{let o=r,l=M(n,_r)(o);return C(l,a=>Hi(i,t,a))}}}function Yo(e,t){return r=>Hi(e,t,r)}function Zo(){return U(u([k("mt-8 w-8 h-8 animate-spin rounded-full border-2 border-t-zinc-800 border-x-zinc-800/50 border-b-zinc-800/50")]),u([]))}function wp(e){let t=e,r=Yo(u(["target","previousElementSibling","value"]),q)(t);return S(r,n=>new st(n))}function xp(e){let t=e.preview_url;if(t instanceof $){let r=t[0];return U(u([k("group relative")]),u([nt(u([Qe(e.album_cover),k("w-16 h-16 rounded-sm"),Jt("click",n=>new c(new ut(r)))])),U(u([k("absolute w-full h-full top-0 left-0 group-hover:opacity-100 bg-zinc-100/50 p-2 opacity-0 transition-opacity duration-300")]),u([nt(u([Qe("https://www.svgrepo.com/download/524827/play-circle.svg")]))]))]))}else return U(u([]),u([nt(u([Qe(e.album_cover),k("w-16 h-16 rounded-sm")]))]))}function gp(e){return U(u([k("flex items-center gap-4 py-4 px-8 bg-zinc-700/50 hover:bg-zinc-700/80")]),u([xp(e),U(u([k("flex flex-col flex-1")]),u([Qr(u([k("font-semibold")]),u([H(e.title)])),Qr(u([k("text-sm text-zinc-100/70")]),u([H((()=>{let t=e.artists;return Z(t," - ")})())])),Qr(u([k("text-sm text-zinc-100/70")]),u([H(e.album)]))]))]))}function yp(e){return Mr(t=>Xr(u([k("rounded-lg overflow-clip mt-8 w-full")]),t),E(e,t=>{let r=Zr(u([]),u([gp(t)]));return[t.id,r]}))}function Xo(e,t){return u([U(u([k("rounded-md overflow-clip flex items-stretch")]),u([xo(u([k("py-2 px-4 bg-zinc-700/30 hover:bg-zinc-700/70 focus:bg-zinc-600/80"),Cr("search-songs")])),en(u([k("bg-zinc-700 hover:bg-zinc-600 py-2 px-4"),Jt("click",wp)]),u([H("Search")]))])),e?Zo():yp(t)])}var ft=class extends p{constructor(t){super(),this.msg=t}},hn=class extends p{constructor(t){super(),this.err=t}};var Kt=class extends p{},wn=class extends p{},dt=class extends p{},xn=class extends p{constructor(t,r){super(),this.encoder=t,this.decoder=r}},gn=class extends p{constructor(t,r){super(),this.btype=t,this.converter=r}};function Wi(){return new gn(new Kt,new xn(e=>Fn(),e=>new c(void 0)))}function yn(e,t){return new gn(new dt,new xn(r=>{let i=e(r);return Vs(i)},r=>{let n=jr(r,t);return le(n,i=>new hn(i))}))}function Ji(e,t){let r=t;return e.converter.encoder(r)}function Qo(e,t){let r=t;return e.converter.decoder(r)}function tl(e){return e.btype}var Ki=class extends p{};var Vi=class extends p{constructor(t,r){super(),this.encoder=t,this.decoder=r}},Yi=class extends p{constructor(t,r){super(),this.ptype=t,this.converter=r}};function _t(e){return new Yi(new Ki,new Vi(t=>e,t=>we(b(t,e),new c(void 0),()=>new f(void 0))))}function rl(e,t){let r=t;return e.converter.encoder(r)}function nl(e){return e.ptype}var Vt=class extends p{},Yt=class extends p{},Zt=class extends p{constructor(t,r){super(),this.encoder=t,this.decoder=r}},An=class extends p{constructor(t,r){super(),this.qtype=t,this.converter=r}};function il(){return new An(new Vt,new Zt(e=>u([]),e=>new c(void 0)))}function sl(e){return new An(new Yt,e)}function ol(e,t){let r=t;return e.converter.encoder(r)}function ll(e){return e.qtype}var $t=class extends p{constructor(t,r,n,i,s){super(),this.method=t,this.path=r,this.query=n,this.req_body=i,this.res_body=s}};function Ln(){return new $t(new re,_t(u([])),il(),Wi(),Wi())}function vn(e,t){return e.withFields({method:t})}function On(e,t){return new $t(e.method,t,e.query,e.req_body,e.res_body)}function ul(e,t){return new $t(e.method,e.path,t,e.req_body,e.res_body)}function jn(e,t){return new $t(e.method,e.path,e.query,e.req_body,t)}var Xt=class extends p{constructor(t,r,n){super(),this.scheme=t,this.host=r,this.port=n}},Xi=class extends p{constructor(t,r,n,i,s,o,l){super(),this.route=t,this.scheme=r,this.host=n,this.port=i,this.path_opt=s,this.query_opt=o,this.body_opt=l}};function pl(){return new Xt(new ye,"localhost",80)}function cl(e,t){return t instanceof ye?new Xt(new ye,e.host,80):new Xt(new Re,e.host,443)}function fl(e,t){return e.withFields({host:t})}function dl(e,t){return e.withFields({port:t})}function En(e,t){return new Xi(t,e.scheme,e.host,e.port,new _,new _,new _)}function Tn(e,t){return e.withFields({path_opt:new $(t)})}function _l(e,t){return e.withFields({query_opt:new $(t)})}function kp(e,t,r,n){let i=(()=>{let o=t.route.path;return nl(o)})(),s=t.path_opt;if(s instanceof _)return r("Path option is missing, please call with_path before send");{let o=s[0];return n(qo(e,(()=>{let a=t.route.path,d=rl(a,o);return Z(d,"/")})()))}}function Ap(e,t,r,n){let i=(()=>{let o=t.route.query;return ll(o)})(),s=t.query_opt;if(i instanceof Yt&&s instanceof _)return r("Query option is missing, please call with_query before send");if(i instanceof Vt)return n(e);{let o=s[0];return n(jo(e,(()=>{let a=t.route.query;return ol(a,o)})()))}}function Lp(e,t,r,n){let i=(()=>{let o=t.route.req_body;return tl(o)})(),s=t.body_opt;if(i instanceof dt&&s instanceof _)return r("Body option is missing, please call with_body before send");if(i instanceof wn&&s instanceof _)return r("Body option is missing, please call with_body before send");if(i instanceof Kt)return n(e);if(i instanceof dt&&s instanceof $){let o=s[0];return n((()=>{let a=an(e,(()=>{let d=t.route.req_body,h=Ji(d,o);return Y(h)})());return qi(a,"Content-Type","application/json")})())}else{let o=s[0];return n(an(e,(()=>{let a=t.route.req_body,d=Ji(a,o);return Y(d)})()))}}function vp(e){if(e instanceof ft){let t=e.msg;return new Wt(500,t)}else{let t=e.err;return new fn(t)}}function Sn(e,t,r){let n=(()=>{let i=Eo();return Mi(i,e.route.method)})();return kp(n,e,r,i=>Ap(i,e,r,s=>Lp(s,e,r,o=>{let a=(()=>{let h=To(o,e.scheme),w=So(h,e.host);return Co(w,e.port)})();return Io(a,Go(d=>{let w=C(d,g=>{let L=e.route.res_body,K=Qo(L,g);return le(K,vp)});return t(w)}))})))}var Qt=class extends p{constructor(t,r,n){super(),this.root_path=t,this.base=r,this.upsert=n}};function $l(){return new Qt(u([]),new _,new _)}function ml(e,t){return e.withFields({root_path:t})}function hl(e,t,r){return new Qt(e.root_path,new $([t,r]),e.upsert)}function wl(e,t,r){return new Qt(e.root_path,e.base,new $([t,r]))}function xl(e){let t=e.base;if(t instanceof _)return new f(new ft("No base type provided, make sure you called with_base_type"));{let r=t[0],n=Ln(),i=vn(n,new re),s=On(i,_t(e.root_path)),o=jn(s,yn(l=>xe(l,r[0]),ae(r[1])));return new c(o)}}function jp(){let e=$l(),t=ml(e,u(["playlists"])),r=hl(t,Bo,Ro);return wl(r,Ho,Uo)}function gl(){let e=jp();return xl(e)}function qn(){let e=pl(),t=cl(e,new ye),r=fl(t,"localhost");return dl(r,2345)}function bl(e,t){return Sn(e,n=>{if(n.isOk()){let i=n[0];return t(i)}else{let i=n[0];return new lt(i)}},n=>te(i=>i(new Ne(n))))}function kl(e,t){if(e.isOk()){let r=e[0];return t(r)}else{let r=e[0];return te(n=>Ci(r))}}function Al(){return kl(gl(),e=>{let t=qn(),r=En(t,e),n=Tn(r,void 0);return bl(n,i=>new at(i))})}var er=class extends p{constructor(t,r){super(),this.search=t,this.token=r}};function Cp(e){return u([["q",e.search],["token",e.token]])}function qp(e){return N(he(e,"q"),t=>N(he(e,"token"),r=>new c(new er(t,r))))}function Ll(){let e=Ln(),t=vn(e,new re),r=On(t,_t(u(["songs","search"]))),n=ul(r,sl(new Zt(Cp,qp)));return jn(n,yn(i=>xe(i,$n),ae(mn)))}function vl(e,t){let r=qn(),n=En(r,Ll()),i=Tn(n,void 0),s=_l(i,new er(e,t));return Sn(s,o=>{if(o.isOk()){let l=o[0];return new ot(l)}else{let l=o[0];return new lt(l)}},o=>te(l=>l(new Ne(o))))}var tr=class extends p{constructor(t,r,n,i,s){super(),this.token=t,this.last_search=r,this.searching=n,this.results=i,this.playlists=s}};function Np(e){let t=(()=>{let r=Ar(Si()),n=C(r,s=>di((()=>{let o=s.query;return ve(o,"")})())),i=C(n,s=>he(s,"token"));return Je(i,"")})();return[new tr(t,"",!1,u([]),u([])),Al()]}function Pp(e,t){if(t instanceof st){let r=t.search;return[e.withFields({last_search:r,searching:!0}),vl(r,e.token)]}else if(t instanceof ot){let r=t.results;return[e.withFields({searching:!1,results:r}),Tr()]}else if(t instanceof at){let r=t.playlists;return[e.withFields({playlists:E(r,i=>[i.id,i])}),Tr()]}else if(t instanceof ut){let r=t.preview_url;return[e,te(n=>{let i=Oi(r);ji(i)})]}else if(t instanceof pt){let r=t.id;return[e,te(n=>{let i=Ei(r),s=S(i,o=>Ti(o,"open","True"));return Je(s,void 0)})]}else if(t instanceof Ne){let r=t.message;return[e,te(n=>Vr(r))]}else{let r=t.error;return[e,te(n=>Vr(r))]}}function Fp(e){let t=(()=>{if(e instanceof tr&&e.token===""){let n=e.token;return Wo()}else{let n=e.searching,i=e.results;return Xo(n,i)}})(),r=Vo(e.playlists);return Jo(t,r)}function Ol(){let e=ao(Np,Pp,Fp),t=po(e,"#app",void 0);if(!t.isOk())throw Le("assignment_no_match","client",26,"main","Assignment pattern did not match",{value:t})}Ol();
