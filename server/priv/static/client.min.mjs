var a=class{withFields(t){let r=Object.keys(this).map(n=>n in t?t[n]:this[n]);return new this.constructor(...r)}},C=class{static fromArray(t,r){let n=r||new vr;for(let i=t.length-1;i>=0;--i)n=new jt(t[i],n);return n}[Symbol.iterator](){return new Jn(this)}toArray(){return[...this]}atLeastLength(t){for(let r of this){if(t<=0)return!0;t--}return t<=0}hasLength(t){for(let r of this){if(t<=0)return!1;t--}return t===0}countLength(){let t=0;for(let r of this)t++;return t}};function m(e,t){return new jt(e,t)}function u(e,t){return C.fromArray(e,t)}var Jn=class{#e;constructor(t){this.#e=t}next(){if(this.#e instanceof vr)return{done:!0};{let{head:t,tail:r}=this.#e;return this.#e=r,{value:t,done:!1}}}},vr=class extends C{},jt=class extends C{constructor(t,r){super(),this.head=t,this.tail=r}},Et=class e{constructor(t){if(!(t instanceof Uint8Array))throw"BitArray can only be constructed from a Uint8Array";this.buffer=t}get length(){return this.buffer.length}byteAt(t){return this.buffer[t]}floatFromSlice(t,r,n){return iu(this.buffer,t,r,n)}intFromSlice(t,r,n,i){return nu(this.buffer,t,r,n,i)}binaryFromSlice(t,r){return new e(this.buffer.slice(t,r))}sliceAfter(t){return new e(this.buffer.slice(t))}},Or=class{constructor(t){this.value=t}};function nu(e,t,r,n,i){let s=0;if(n)for(let o=t;o<r;o++)s=s*256+e[o];else for(let o=r-1;o>=t;o--)s=s*256+e[o];if(i){let l=2**((r-t)*8-1);s>=l&&(s-=l*2)}return s}function iu(e,t,r,n){let i=new DataView(e.buffer),s=r-t;if(s===8)return i.getFloat64(t,!n);if(s===4)return i.getFloat32(t,!n);{let o=`Sized floats must be 32-bit or 64-bit on JavaScript, got size of ${s*8} bits`;throw new globalThis.Error(o)}}var rt=class e extends a{static isResult(t){return t instanceof e}},c=class extends rt{constructor(t){super(),this[0]=t}isOk(){return!0}},f=class extends rt{constructor(t){super(),this[0]=t}isOk(){return!1}};function k(e,t){let r=[e,t];for(;r.length;){let n=r.pop(),i=r.pop();if(n===i)continue;if(!ws(n)||!ws(i)||!fu(n,i)||ou(n,i)||lu(n,i)||uu(n,i)||au(n,i)||pu(n,i)||cu(n,i))return!1;let o=Object.getPrototypeOf(n);if(o!==null&&typeof o.equals=="function")try{if(n.equals(i))continue;return!1}catch{}let[l,p]=su(n);for(let d of l(n))r.push(p(n,d),p(i,d))}return!0}function su(e){if(e instanceof Map)return[t=>t.keys(),(t,r)=>t.get(r)];{let t=e instanceof globalThis.Error?["message"]:[];return[r=>[...t,...Object.keys(r)],(r,n)=>r[n]]}}function ou(e,t){return e instanceof Date&&(e>t||e<t)}function lu(e,t){return e.buffer instanceof ArrayBuffer&&e.BYTES_PER_ELEMENT&&!(e.byteLength===t.byteLength&&e.every((r,n)=>r===t[n]))}function uu(e,t){return Array.isArray(e)&&e.length!==t.length}function au(e,t){return e instanceof Map&&e.size!==t.size}function pu(e,t){return e instanceof Set&&(e.size!=t.size||[...e].some(r=>!t.has(r)))}function cu(e,t){return e instanceof RegExp&&(e.source!==t.source||e.flags!==t.flags)}function ws(e){return typeof e=="object"&&e!==null}function fu(e,t){return typeof e!="object"&&typeof t!="object"&&(!e||!t)||[Promise,WeakSet,WeakMap,Function].some(n=>e instanceof n)?!1:e.constructor===t.constructor}function Ee(e,t,r,n,i,s){let o=new globalThis.Error(i);o.gleam_error=e,o.module=t,o.line=r,o.fn=n;for(let l in s)o[l]=s[l];return o}var $=class extends a{constructor(t){super(),this[0]=t}},_=class extends a{};function nt(e,t){if(e instanceof $){let r=e[0];return new c(r)}else return new f(t)}function Tt(e){if(e.isOk()){let t=e[0];return new $(t)}else return new _}function Te(e,t){return e instanceof $?e[0]:t}function jr(e,t){if(e instanceof $){let r=e[0];return new $(t(r))}else return new _}var it=class extends a{constructor(t,r){super(),this.content=t,this.submatches=r}},Er=class extends a{constructor(t,r){super(),this.error=t,this.byte_index=r}},Tr=class extends a{constructor(t,r){super(),this.case_insensitive=t,this.multi_line=r}};function xs(e,t){return gs(e,t)}function Sr(e,t){return ys(e,t)}function St(e){return e>=0?e:e*-1}function Se(e){return ks(e)}function j(e){return As(e)}function Ls(e){return e[1]}function _u(e,t){for(;;){let r=e,n=t;if(r.atLeastLength(1))e=r.tail,t=n+1;else return n}}function Zn(e){return _u(e,0)}function $u(e,t){for(;;){let r=e,n=t;if(r.hasLength(0))return n;{let i=r.head;e=r.tail,t=m(i,n)}}}function G(e){return $u(e,u([]))}function Ct(e){if(e.hasLength(0))return new f(void 0);{let t=e.head;return new c(t)}}function mu(e,t,r){for(;;){let n=e,i=t,s=r;if(n.hasLength(0))return G(s);{let o=n.head;e=n.tail,t=i,r=m(i(o),s)}}}function E(e,t){return mu(e,t,u([]))}function hu(e,t,r,n){for(;;){let i=e,s=t,o=r,l=n;if(i.hasLength(0))return G(l);{let p=i.head,d=i.tail,h=m(s(p,o),l);e=d,t=s,r=o+1,n=h}}}function zr(e,t){return hu(e,t,0,u([]))}function wu(e,t,r){for(;;){let n=e,i=t,s=r;if(n.hasLength(0))return new c(G(s));{let o=n.head,l=n.tail,p=i(o);if(p.isOk()){let d=p[0];e=l,t=i,r=m(d,s)}else{let d=p[0];return new f(d)}}}}function qt(e,t){return wu(e,t,u([]))}function Mt(e,t){for(;;){let r=e,n=t;if(n<=0)return r;if(r.hasLength(0))return u([]);e=r.tail,t=n-1}}function xu(e,t,r){for(;;){let n=e,i=t,s=r;if(i<=0)return G(s);if(n.hasLength(0))return G(s);{let l=n.head;e=n.tail,t=i-1,r=m(l,s)}}}function Xn(e,t){return xu(e,t,u([]))}function gu(e,t){for(;;){let r=e,n=t;if(r.hasLength(0))return n;{let i=r.head;e=r.tail,t=m(i,n)}}}function xe(e,t){return gu(G(e),t)}function yu(e,t){for(;;){let r=e,n=t;if(r.hasLength(0))return n;{let i=r.head;e=r.tail,t=m(i,n)}}}function bu(e,t){for(;;){let r=e,n=t;if(r.hasLength(0))return G(n);{let i=r.head;e=r.tail,t=yu(i,n)}}}function Qn(e){return bu(e,u([]))}function He(e,t,r){for(;;){let n=e,i=t,s=r;if(n.hasLength(0))return i;{let o=n.head;e=n.tail,t=s(i,o),r=s}}}function ku(e,t,r,n){for(;;){let i=e,s=t,o=r,l=n;if(i.hasLength(0))return s;{let p=i.head;e=i.tail,t=o(s,p,l),r=o,n=l+1}}}function ei(e,t,r){return ku(e,t,r,0)}function Au(e,t){for(;;){let r=e,n=t;if(r.hasLength(0))return new f(void 0);{let i=r.head,s=r.tail,o=n(i);if(o.isOk()){let l=o[0];return new c(l)}else e=s,t=n}}}function Lu(e,t,r){for(;;){let n=e,i=t,s=r;if(n.hasLength(0))return G(s);{let o=n.head;e=n.tail,t=i,r=m(o,m(i,s))}}}function Nr(e,t){if(e.hasLength(0))return e;if(e.hasLength(1))return e;{let r=e.head,n=e.tail;return Lu(n,t,u([r]))}}function vu(e,t,r){for(;;){let n=e,i=t,s=r;if(i<=0)return s;e=n,t=i-1,r=m(n,s)}}function vs(e,t){return vu(e,t,u([]))}function ge(e,t){return Au(e,r=>{let n=r[0],i=r[1];return k(n,t)?new c(i):new f(void 0)})}function Pr(e,t,r){if(e.hasLength(0))return u([[t,r]]);if(e.atLeastLength(1)&&k(e.head[0],t)){let n=e.head[0],i=e.tail;return m([t,r],i)}else{let n=e.head,i=e.tail;return m(n,Pr(i,t,r))}}function T(e,t){if(e.isOk()){let r=e[0];return new c(t(r))}else{let r=e[0];return new f(r)}}function pe(e,t){if(e.isOk()){let r=e[0];return new c(r)}else{let r=e[0];return new f(t(r))}}function N(e,t){if(e.isOk()){let r=e[0];return t(r)}else{let r=e[0];return new f(r)}}function q(e,t){return N(e,t)}function Re(e,t){return e.isOk()?e[0]:t}function Os(e){return pe(e,t=>{})}function ti(e,t){if(e.isOk()){let r=e[0];return new c(r)}else return new f(t)}function ri(){return Pt(u([]))}function qe(e){return Pt(e)}function ni(e){return Pt(e)}function Nt(e){return e}function K(e){return e}function si(e){return Ss(e)}function ze(e){return ii(e)}function It(e,t){return Ms(e,t)}function Dt(e){let r=qe(e);return K(r)}function Q(e,t){return qs(e,t)}function Gt(e){return Cs(e)}function Es(e,t,r){let i=Ir(e),s=Mt(i,t),o=Xn(s,r);return Dt(o)}function Ts(e,t,r){if(r<0)return"";if(t<0){let s=si(e)+t;return s<0?"":Es(e,s,r)}else return Es(e,t,r)}function Dr(e,t){return t<0?e:Ts(e,t,si(e)-t)}function Gr(e){let t=ce(e);return K(t)}var V=class extends a{constructor(t,r,n){super(),this.expected=t,this.found=r,this.path=n}};function Br(e){return new c(e)}function Bt(e){return di(e)}function Ps(e){return Gs(e)}function zu(e){return Hs(e)}function Fs(e){return t=>Rs(t,e)}function Ns(e,t){let r=e===1?"":"s",n=(()=>{let i=u(["Tuple of at least ",j(e)," element",r]),s=qe(i),o=K(s);return new V(o,Bt(t),u([]))})();return new f(u([n]))}function Hr(e){return t=>{if(e.hasLength(0))return new f(u([new V("another type",Bt(t),u([]))]));{let r=e.head,n=e.tail,i=r(t);if(i.isOk()){let s=i[0];return new c(s)}else return Hr(n)(t)}}}function se(e){return e.isOk()?u([]):e[0]}function ui(e,t){return r=>{let n=t(r);if(n.isOk()){let i=n[0];return new c(e(i))}else{let i=n;return new f(se(i))}}}function ai(e,t){let r=t,n=Hr(u([M,s=>T(Ps(s),j)])),i=(()=>{let s=n(r);if(s.isOk())return s[0];{let o=u(["<",Bt(r),">"]),l=qe(o);return K(l)}})();return e.withFields({path:m(i,e.path)})}function fe(e){return t=>N(zu(t),r=>{let i=qt(r,e);return pi(i,s=>ai(s,"*"))})}function pi(e,t){return pe(e,r=>E(r,t))}function M(e){return Ds(e)}function z(e,t){return r=>{let n=new V("field","nothing",u([]));return N(Us(r,e),i=>{let o=nt(i,u([n])),l=N(o,t);return pi(l,p=>ai(p,e))})}}function ci(e,t){return r=>N(Bs(r),n=>{let i=Ft(n);return N(e>=0?e<i?li(n,e):Ns(e+1,r):St(e)<=i?li(n,i+e):Ns(St(e),r),s=>{let o=t(s);return pi(o,l=>ai(l,e))})})}function fi(e,t,r,n){return i=>{let s=t(i),o=r(i),l=n(i);if(s.isOk()&&o.isOk()&&l.isOk()){let p=s[0],d=o[0],h=l[0];return new c(e(p,d,h))}else{let p=s,d=o,h=l;return new f(Qn(u([se(p),se(d),se(h)])))}}}function Is(e,t,r,n,i,s,o,l){return p=>{let d=t(p),h=r(p),x=n(p),y=i(p),L=s(p),Z=o(p),Oe=l(p);if(d.isOk()&&h.isOk()&&x.isOk()&&y.isOk()&&L.isOk()&&Z.isOk()&&Oe.isOk()){let je=d[0],me=h[0],g=x[0],b=y[0],S=L[0],D=Z[0],he=Oe[0];return new c(e(je,me,g,b,S,D,he))}else{let je=d,me=h,g=x,b=y,S=L,D=Z,he=Oe;return new f(Qn(u([se(je),se(me),se(g),se(b),se(S),se(D),se(he)])))}}}var Ws=new WeakMap,_i=new DataView(new ArrayBuffer(8)),$i=0;function mi(e){let t=Ws.get(e);if(t!==void 0)return t;let r=$i++;return $i===2147483647&&($i=0),Ws.set(e,r),r}function hi(e,t){return e^t+2654435769+(e<<6)+(e>>2)|0}function xi(e){let t=0,r=e.length;for(let n=0;n<r;n++)t=Math.imul(31,t)+e.charCodeAt(n)|0;return t}function Js(e){_i.setFloat64(0,e);let t=_i.getInt32(0),r=_i.getInt32(4);return Math.imul(73244475,t>>16^t)^r}function Nu(e){return xi(e.toString())}function Pu(e){let t=Object.getPrototypeOf(e);if(t!==null&&typeof t.hashCode=="function")try{let n=e.hashCode(e);if(typeof n=="number")return n}catch{}if(e instanceof Promise||e instanceof WeakSet||e instanceof WeakMap)return mi(e);if(e instanceof Date)return Js(e.getTime());let r=0;if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),Array.isArray(e)||e instanceof Uint8Array)for(let n=0;n<e.length;n++)r=Math.imul(31,r)+te(e[n])|0;else if(e instanceof Set)e.forEach(n=>{r=r+te(n)|0});else if(e instanceof Map)e.forEach((n,i)=>{r=r+hi(te(n),te(i))|0});else{let n=Object.keys(e);for(let i=0;i<n.length;i++){let s=n[i],o=e[s];r=r+hi(te(o),xi(s))|0}}return r}function te(e){if(e===null)return 1108378658;if(e===void 0)return 1108378659;if(e===!0)return 1108378657;if(e===!1)return 1108378656;switch(typeof e){case"number":return Js(e);case"string":return xi(e);case"bigint":return Nu(e);case"object":return Pu(e);case"symbol":return mi(e);case"function":return mi(e);default:return 0}}var _e=5,gi=Math.pow(2,_e),Fu=gi-1,Iu=gi/2,Du=gi/4,H=0,de=1,Y=2,Ue=3,yi={type:Y,bitmap:0,array:[]};function Ht(e,t){return e>>>t&Fu}function Wr(e,t){return 1<<Ht(e,t)}function Gu(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),e=e+(e>>4)&252645135,e+=e>>8,e+=e>>16,e&127}function bi(e,t){return Gu(e&t-1)}function re(e,t,r){let n=e.length,i=new Array(n);for(let s=0;s<n;++s)i[s]=e[s];return i[t]=r,i}function Bu(e,t,r){let n=e.length,i=new Array(n+1),s=0,o=0;for(;s<t;)i[o++]=e[s++];for(i[o++]=r;s<n;)i[o++]=e[s++];return i}function wi(e,t){let r=e.length,n=new Array(r-1),i=0,s=0;for(;i<t;)n[s++]=e[i++];for(++i;i<r;)n[s++]=e[i++];return n}function Ks(e,t,r,n,i,s){let o=te(t);if(o===n)return{type:Ue,hash:o,array:[{type:H,k:t,v:r},{type:H,k:i,v:s}]};let l={val:!1};return Rt(ki(yi,e,o,t,r,l),e,n,i,s,l)}function Rt(e,t,r,n,i,s){switch(e.type){case de:return Hu(e,t,r,n,i,s);case Y:return ki(e,t,r,n,i,s);case Ue:return Ru(e,t,r,n,i,s)}}function Hu(e,t,r,n,i,s){let o=Ht(r,t),l=e.array[o];if(l===void 0)return s.val=!0,{type:de,size:e.size+1,array:re(e.array,o,{type:H,k:n,v:i})};if(l.type===H)return k(n,l.k)?i===l.v?e:{type:de,size:e.size,array:re(e.array,o,{type:H,k:n,v:i})}:(s.val=!0,{type:de,size:e.size,array:re(e.array,o,Ks(t+_e,l.k,l.v,r,n,i))});let p=Rt(l,t+_e,r,n,i,s);return p===l?e:{type:de,size:e.size,array:re(e.array,o,p)}}function ki(e,t,r,n,i,s){let o=Wr(r,t),l=bi(e.bitmap,o);if(e.bitmap&o){let p=e.array[l];if(p.type!==H){let h=Rt(p,t+_e,r,n,i,s);return h===p?e:{type:Y,bitmap:e.bitmap,array:re(e.array,l,h)}}let d=p.k;return k(n,d)?i===p.v?e:{type:Y,bitmap:e.bitmap,array:re(e.array,l,{type:H,k:n,v:i})}:(s.val=!0,{type:Y,bitmap:e.bitmap,array:re(e.array,l,Ks(t+_e,d,p.v,r,n,i))})}else{let p=e.array.length;if(p>=Iu){let d=new Array(32),h=Ht(r,t);d[h]=ki(yi,t+_e,r,n,i,s);let x=0,y=e.bitmap;for(let L=0;L<32;L++){if(y&1){let Z=e.array[x++];d[L]=Z}y=y>>>1}return{type:de,size:p+1,array:d}}else{let d=Bu(e.array,l,{type:H,k:n,v:i});return s.val=!0,{type:Y,bitmap:e.bitmap|o,array:d}}}}function Ru(e,t,r,n,i,s){if(r===e.hash){let o=Ai(e,n);if(o!==-1)return e.array[o].v===i?e:{type:Ue,hash:r,array:re(e.array,o,{type:H,k:n,v:i})};let l=e.array.length;return s.val=!0,{type:Ue,hash:r,array:re(e.array,l,{type:H,k:n,v:i})}}return Rt({type:Y,bitmap:Wr(e.hash,t),array:[e]},t,r,n,i,s)}function Ai(e,t){let r=e.array.length;for(let n=0;n<r;n++)if(k(t,e.array[n].k))return n;return-1}function Ur(e,t,r,n){switch(e.type){case de:return Uu(e,t,r,n);case Y:return Wu(e,t,r,n);case Ue:return Ju(e,n)}}function Uu(e,t,r,n){let i=Ht(r,t),s=e.array[i];if(s!==void 0){if(s.type!==H)return Ur(s,t+_e,r,n);if(k(n,s.k))return s}}function Wu(e,t,r,n){let i=Wr(r,t);if(!(e.bitmap&i))return;let s=bi(e.bitmap,i),o=e.array[s];if(o.type!==H)return Ur(o,t+_e,r,n);if(k(n,o.k))return o}function Ju(e,t){let r=Ai(e,t);if(!(r<0))return e.array[r]}function Li(e,t,r,n){switch(e.type){case de:return Ku(e,t,r,n);case Y:return Vu(e,t,r,n);case Ue:return Yu(e,n)}}function Ku(e,t,r,n){let i=Ht(r,t),s=e.array[i];if(s===void 0)return e;let o;if(s.type===H){if(!k(s.k,n))return e}else if(o=Li(s,t+_e,r,n),o===s)return e;if(o===void 0){if(e.size<=Du){let l=e.array,p=new Array(e.size-1),d=0,h=0,x=0;for(;d<i;){let y=l[d];y!==void 0&&(p[h]=y,x|=1<<d,++h),++d}for(++d;d<l.length;){let y=l[d];y!==void 0&&(p[h]=y,x|=1<<d,++h),++d}return{type:Y,bitmap:x,array:p}}return{type:de,size:e.size-1,array:re(e.array,i,o)}}return{type:de,size:e.size,array:re(e.array,i,o)}}function Vu(e,t,r,n){let i=Wr(r,t);if(!(e.bitmap&i))return e;let s=bi(e.bitmap,i),o=e.array[s];if(o.type!==H){let l=Li(o,t+_e,r,n);return l===o?e:l!==void 0?{type:Y,bitmap:e.bitmap,array:re(e.array,s,l)}:e.bitmap===i?void 0:{type:Y,bitmap:e.bitmap^i,array:wi(e.array,s)}}return k(n,o.k)?e.bitmap===i?void 0:{type:Y,bitmap:e.bitmap^i,array:wi(e.array,s)}:e}function Yu(e,t){let r=Ai(e,t);if(r<0)return e;if(e.array.length!==1)return{type:Ue,hash:e.hash,array:wi(e.array,r)}}function Vs(e,t){if(e===void 0)return;let r=e.array,n=r.length;for(let i=0;i<n;i++){let s=r[i];if(s!==void 0){if(s.type===H){t(s.v,s.k);continue}Vs(s,t)}}}var Ne=class e{static fromObject(t){let r=Object.keys(t),n=e.new();for(let i=0;i<r.length;i++){let s=r[i];n=n.set(s,t[s])}return n}static fromMap(t){let r=e.new();return t.forEach((n,i)=>{r=r.set(i,n)}),r}static new(){return new e(void 0,0)}constructor(t,r){this.root=t,this.size=r}get(t,r){if(this.root===void 0)return r;let n=Ur(this.root,0,te(t),t);return n===void 0?r:n.v}set(t,r){let n={val:!1},i=this.root===void 0?yi:this.root,s=Rt(i,0,te(t),t,r,n);return s===this.root?this:new e(s,n.val?this.size+1:this.size)}delete(t){if(this.root===void 0)return this;let r=Li(this.root,0,te(t),t);return r===this.root?this:r===void 0?e.new():new e(r,this.size-1)}has(t){return this.root===void 0?!1:Ur(this.root,0,te(t),t)!==void 0}entries(){if(this.root===void 0)return[];let t=[];return this.forEach((r,n)=>t.push([n,r])),t}forEach(t){Vs(this.root,t)}hashCode(){let t=0;return this.forEach((r,n)=>{t=t+hi(te(r),te(n))|0}),t}equals(t){if(!(t instanceof e)||this.size!==t.size)return!1;let r=!0;return this.forEach((n,i)=>{r=r&&k(t.get(i,!n),n)}),r}};var Ut=void 0,Ys={};function ks(e){return/^[-+]?(\d+)$/.test(e)?new c(parseInt(e)):new f(Ut)}function As(e){return e.toString()}function Ss(e){if(e==="")return 0;let t=vi(e);if(t){let r=0;for(let n of t)r++;return r}else return e.match(/./gsu).length}function Ir(e){let t=vi(e);return t?C.fromArray(Array.from(t).map(r=>r.segment)):C.fromArray(e.match(/./gsu))}function vi(e){if(globalThis.Intl&&Intl.Segmenter)return new Intl.Segmenter().segment(e)[Symbol.iterator]()}function Cs(e){let t,r=vi(e);return r?t=r.next().value?.segment:t=e.match(/./su)?.[0],t?new c([t,e.slice(t.length)]):new f(Ut)}function ii(e){return e.toLowerCase()}function qs(e,t){let r=e[Symbol.iterator](),n=r.next().value||"",i=r.next();for(;!i.done;)n=n+t+i.value,i=r.next();return n}function Pt(e){let t="";for(let r of e)t=t+r;return t}function Ft(e){return e.length}function Ms(e,t){return e.startsWith(t)}var eo=[" ","	",`
`,"\v","\f","\r","\x85","\u2028","\u2029"].join(""),dd=new RegExp(`^([${eo}]*)`,"g"),_d=new RegExp(`([${eo}]*)$`,"g");function to(e){typeof process=="object"&&process.stderr?.write?process.stderr.write(e+`
`):typeof Deno=="object"?Deno.stderr.writeSync(new TextEncoder().encode(e+`
`)):console.log(e)}function gs(e,t){try{let r="gu";return t.case_insensitive&&(r+="i"),t.multi_line&&(r+="m"),new c(new RegExp(e,r))}catch(r){let n=(r.columnNumber||0)|0;return new f(new Er(r.message,n))}}function ys(e,t){let r=Array.from(t.matchAll(e)).map(n=>{let i=n[0],s=[];for(let o=n.length-1;o>0;o--){if(n[o]){s[o-1]=new $(n[o]);continue}s.length>0&&(s[o-1]=new _)}return new it(i,C.fromArray(s))});return C.fromArray(r)}function ro(){return Ne.new()}function st(e){return C.fromArray(e.entries())}function no(e,t){return t.delete(e)}function io(e,t){let r=e.get(t,Ys);return r===Ys?new f(Ut):new c(r)}function so(e,t,r){return r.set(e,t)}function Zs(e){return decodeURIComponent((e||"").replace("+"," "))}function oo(e){return encodeURIComponent(e).replace("%2B","+")}function lo(e){try{let t=[];for(let r of e.split("&")){let[n,i]=r.split("=");if(!n)continue;let s=Zs(n),o=Zs(i);t.push([s,o])}return new c(C.fromArray(t))}catch{return new f(Ut)}}function di(e){if(typeof e=="string")return"String";if(typeof e=="boolean")return"Bool";if(e instanceof rt)return"Result";if(e instanceof C)return"List";if(e instanceof Et)return"BitArray";if(e instanceof Ne)return"Dict";if(Number.isInteger(e))return"Int";if(Array.isArray(e))return`Tuple of ${e.length} elements`;if(typeof e=="number")return"Float";if(e===null)return"Null";if(e===void 0)return"Nil";{let t=typeof e;return t.charAt(0).toUpperCase()+t.slice(1)}}function Wt(e,t){return Zu(e,di(t))}function Zu(e,t){return new f(C.fromArray([new V(e,t,C.fromArray([]))]))}function Ds(e){return typeof e=="string"?new c(e):Wt("String",e)}function Gs(e){return Number.isInteger(e)?new c(e):Wt("Int",e)}function Bs(e){return Array.isArray(e)?new c(e):Wt("Tuple",e)}function li(e,t){return t>=0&&e.length>t?new c(e[t]):new f(Ut)}function Hs(e){return Array.isArray(e)?new c(C.fromArray(e)):e instanceof C?new c(e):Wt("List",e)}function Rs(e,t){if(e==null||e instanceof _)return new c(new _);e instanceof $&&(e=e[0]);let r=t(e);return r.isOk()?new c(new $(r[0])):r}function Us(e,t){let r=()=>Wt("Dict",e);if(e instanceof Ne||e instanceof WeakMap||e instanceof Map){let n=io(e,t);return new c(n.isOk()?new $(n[0]):new _)}else return e===null?r():Object.getPrototypeOf(e)==Object.prototype?Xs(e,t,()=>new c(new _)):Xs(e,t,r)}function Xs(e,t,r){try{return t in e?new c(new $(e[t])):r()}catch{return r()}}function ce(e){let t=typeof e;if(e===!0)return"True";if(e===!1)return"False";if(e===null)return"//js(null)";if(e===void 0)return"Nil";if(t==="string")return Xu(e);if(t==="bigint"||t==="number")return e.toString();if(Array.isArray(e))return`#(${e.map(ce).join(", ")})`;if(e instanceof C)return ra(e);if(e instanceof Or)return ia(e);if(e instanceof Et)return na(e);if(e instanceof a)return ta(e);if(e instanceof Ne)return Qu(e);if(e instanceof Set)return`//js(Set(${[...e].map(ce).join(", ")}))`;if(e instanceof RegExp)return`//js(${e})`;if(e instanceof Date)return`//js(Date("${e.toISOString()}"))`;if(e instanceof Function){let r=[];for(let n of Array(e.length).keys())r.push(String.fromCharCode(n+97));return`//fn(${r.join(", ")}) { ... }`}return ea(e)}function Xu(e){let t='"';for(let r=0;r<e.length;r++){let n=e[r];switch(n){case`
`:t+="\\n";break;case"\r":t+="\\r";break;case"	":t+="\\t";break;case"\f":t+="\\f";break;case"\\":t+="\\\\";break;case'"':t+='\\"';break;default:n<" "||n>"~"&&n<"\xA0"?t+="\\u{"+n.charCodeAt(0).toString(16).toUpperCase().padStart(4,"0")+"}":t+=n}}return t+='"',t}function Qu(e){let t="dict.from_list([",r=!0;return e.forEach((n,i)=>{r||(t=t+", "),t=t+"#("+ce(i)+", "+ce(n)+")",r=!1}),t+"])"}function ea(e){let t=Object.getPrototypeOf(e)?.constructor?.name||"Object",r=[];for(let s of Object.keys(e))r.push(`${ce(s)}: ${ce(e[s])}`);let n=r.length?" "+r.join(", ")+" ":"";return`//js(${t==="Object"?"":t+" "}{${n}})`}function ta(e){let t=Object.keys(e).map(r=>{let n=ce(e[r]);return isNaN(parseInt(r))?`${r}: ${n}`:n}).join(", ");return t?`${e.constructor.name}(${t})`:e.constructor.name}function ra(e){return`[${e.toArray().map(ce).join(", ")}]`}function na(e){return`<<${Array.from(e.buffer).join(", ")}>>`}function ia(e){return`//utfcodepoint(${String.fromCodePoint(e.value)})`}function J(){return ro()}function ie(e,t,r){return so(t,r,e)}function oa(e,t){for(;;){let r=e,n=t;if(r.hasLength(0))return n;{let i=r.head;e=r.tail,t=ie(n,i[0],i[1])}}}function Rr(e){return oa(e,J())}function la(e,t){for(;;){let r=e,n=t;if(r.hasLength(0))return n;{let i=r.head;e=r.tail,t=m(i,n)}}}function ua(e,t){for(;;){let r=e,n=t;if(r.hasLength(0))return la(n,u([]));{let i=r.head;e=r.tail,t=m(i[0],n)}}}function aa(e){let t=st(e);return ua(t,u([]))}function Jr(e){return aa(e)}function Oi(e,t){return no(t,e)}function uo(e,t){for(;;){let r=e,n=t;if(n.hasLength(0))return r;{let i=n.head,s=n.tail;e=Oi(r,i),t=s}}}var Jt=class extends a{constructor(t,r,n,i,s,o,l){super(),this.scheme=t,this.userinfo=r,this.host=n,this.port=i,this.path=s,this.query=o,this.fragment=l}};function ao(e,t){let n=xs(e,new Tr(!0,!1)),i=Os(n),s=T(i,p=>Sr(p,t)),o=N(s,Ct),l=T(o,p=>p.submatches);return Re(l,u([]))}function pa(e){if(e instanceof _)return new _;{let t=e[0],r=Gt(t);if(r.isOk()&&r[0][0]==="?"){let n=r[0][1];return new $(n)}else return new _}}function Kr(e){return e instanceof $&&e[0]===""?new _:e instanceof _?new _:e}function ca(e,t){for(;;){let r=e,n=t;if(n===0)return 0;if(r.hasLength(0))return n;e=r.tail,t=n-1}}function po(e,t){return xe(e,vs(new _,ca(e,t)))}function fa(e){let t=Te(e,"");if(t==="")return[new _,new _,new _];if(t==="//")return[new _,new $(""),new _];{let r=t,n=(()=>{let s=ao("^(//)?((.*)@)?(\\[[a-zA-Z0-9:.]*\\]|[^:]*)(:(\\d*))?",r);return po(s,6)})();if(n.hasLength(6)){let i=n.tail.tail.head,s=n.tail.tail.tail.head,o=n.tail.tail.tail.tail.tail.head,l=Kr(i),p=Kr(s),d=(()=>{let x=Te(o,""),y=Se(x);return Tt(y)})();return[l,p,d]}else return[new _,new _,new _]}}function da(e){let t="^(([a-z][a-z0-9\\+\\-\\.]*):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#.*)?",r=(()=>{let b=ao(t,e);return po(b,8)})(),n=(()=>{if(r.hasLength(8)){let g=r.tail.head,b=r.tail.tail.head,S=r.tail.tail.tail.tail.head,D=r.tail.tail.tail.tail.tail.head,he=r.tail.tail.tail.tail.tail.tail.tail.head;return[g,b,S,D,he]}else return[new _,new _,new _,new _,new _]})(),i=n[0],s=n[1],o=n[2],l=n[3],p=n[4],d=Kr(i),h=Te(o,""),x=pa(l),y=fa(s),L=y[0],Z=y[1],Oe=y[2],je=(()=>{let b=nt(p,void 0),S=N(b,Gt),D=T(S,Ls);return Tt(D)})(),me=(()=>{let b=Kr(d);return jr(b,ze)})();return new c(new Jt(me,L,Z,Oe,h,x,je))}function Vr(e){return da(e)}function ji(e){return lo(e)}function Ei(e){return oo(e)}function co(e){let t=(()=>{let l=e.fragment;if(l instanceof $){let p=l[0];return u(["#",p])}else return u([])})(),r=(()=>{let l=e.query;if(l instanceof $){let p=l[0];return m("?",m(p,t))}else return t})(),n=m(e.path,r),i=(()=>{let l=e.host,p=It(e.path,"/");if(l instanceof $&&!p&&l[0]!==""){let d=l[0];return m("/",n)}else return n})(),s=(()=>{let l=e.host,p=e.port;if(l instanceof $&&p instanceof $){let d=p[0];return m(":",m(j(d),i))}else return i})(),o=(()=>{let l=e.scheme,p=e.userinfo,d=e.host;if(l instanceof $&&p instanceof $&&d instanceof $){let h=l[0],x=p[0],y=d[0];return m(h,m("://",m(x,m("@",m(y,s)))))}else if(l instanceof $&&p instanceof _&&d instanceof $){let h=l[0],x=d[0];return m(h,m("://",m(x,s)))}else if(l instanceof $&&p instanceof $&&d instanceof _){let h=l[0];return m(h,m(":",s))}else if(l instanceof $&&p instanceof _&&d instanceof _){let h=l[0];return m(h,m(":",s))}else if(l instanceof _&&p instanceof _&&d instanceof $){let h=d[0];return m("//",m(h,s))}else return s})();return Dt(o)}function be(e,t,r){return e?t:r()}function Si(e){return JSON.stringify(e)}function fo(e){return Object.fromEntries(e)}function _o(e){return e.toArray()}function $o(){return null}function mo(e){try{let t=JSON.parse(e);return new c(t)}catch(t){return new f($a(t,e))}}function $a(e,t){return ma(e)?new Zr:ha(e,t)}function ma(e){return/((unexpected (end|eof))|(end of data)|(unterminated string)|(json( parse error|\.parse)\: expected '(\:|\}|\])'))/i.test(e.message)}function ha(e,t){let r=[wa,xa,ya,ga];for(let n of r){let i=n(e,t);if(i)return i}return new Pe("",0)}function wa(e){let r=/unexpected token '(.)', ".+" is not valid JSON/i.exec(e.message);if(!r)return null;let n=Yr(r[1]);return new Pe(n,-1)}function xa(e){let r=/unexpected token (.) in JSON at position (\d+)/i.exec(e.message);if(!r)return null;let n=Yr(r[1]),i=Number(r[2]);return new Pe(n,i)}function ga(e,t){let n=/(unexpected character|expected .*) at line (\d+) column (\d+)/i.exec(e.message);if(!n)return null;let i=Number(n[2]),s=Number(n[3]),o=ba(i,s,t),l=Yr(t[o]);return new Pe(l,o)}function ya(e){let r=/unexpected (identifier|token) "(.)"/i.exec(e.message);if(!r)return null;let n=Yr(r[2]);return new Pe(n,0)}function Yr(e){return"0x"+e.charCodeAt(0).toString(16).toUpperCase()}function ba(e,t,r){if(e===1)return t-1;let n=1,i=0;return r.split("").find((s,o)=>(s===`
`&&(n+=1),n===e?(i=o+t,!0):!1)),i}var Zr=class extends a{},Pe=class extends a{constructor(t,r){super(),this.byte=t,this.position=r}};var Xr=class extends a{constructor(t){super(),this[0]=t}};function Aa(e,t){return q(mo(e),r=>{let n=t(r);return pe(n,i=>new Xr(i))})}function Qr(e,t){return Aa(e,t)}function ho(e){return Si(e)}function F(e){return e}function La(){return $o()}function wo(e,t){if(e instanceof $){let r=e[0];return t(r)}else return La()}function Fe(e){return fo(e)}function qi(e){return _o(e)}function ke(e,t){let n=E(e,t);return qi(n)}var en=class extends a{constructor(t){super(),this.all=t}};function va(e){return new en(u([t=>e(t.dispatch,t.emit,t.select)]))}function W(e){return va((t,r,n)=>e(t))}function Je(){return new en(u([]))}function Mi(e){let r=Gr(e);return to(r),e}var lt=class extends a{constructor(t){super(),this.content=t}},v=class extends a{constructor(t,r,n,i,s,o,l){super(),this.key=t,this.namespace=r,this.tag=n,this.attrs=i,this.children=s,this.self_closing=o,this.void=l}},Ke=class extends a{constructor(t){super(),this.subtree=t}},ut=class extends a{constructor(t,r){super(),this.elements=t,this.key=r}},at=class extends a{constructor(t,r,n){super(),this[0]=t,this[1]=r,this.as_property=n}},Vt=class extends a{constructor(t,r){super(),this[0]=t,this[1]=r}};function Ta(e){if(e instanceof at)return new f(void 0);{let t=e[0],r=e[1],n=Dr(t,2);return new c([n,r])}}function xo(e,t,r){return ei(e,t,(n,i,s)=>{let o=r+"-"+j(s);return go(i,n,o)})}function go(e,t,r){for(;;){let n=e,i=t,s=r;if(n instanceof lt)return i;if(n instanceof Ke){let o=n.subtree;e=o(),t=i,r=s}else if(n instanceof v){let o=n.attrs,l=n.children,p=He(o,i,(d,h)=>{let x=Ta(h);if(x.isOk()){let y=x[0][0],L=x[0][1];return ie(d,s+"-"+y,L)}else return d});return xo(l,p,s)}else{let o=n.elements;return xo(o,i,s)}}}function yo(e){return go(e,J(),"0")}function Yt(e,t){return new at(e,t,!1)}function ko(e,t){return new Vt("on"+e,t)}function w(e){return Yt("class",e)}function Zt(e){return Yt("id",e)}function Ao(e){return Yt("placeholder",e)}function Lo(e){return Yt("href",e)}function pt(e){return Yt("src",e)}function R(e,t,r){return e==="area"?new v("","",e,t,u([]),!1,!0):e==="base"?new v("","",e,t,u([]),!1,!0):e==="br"?new v("","",e,t,u([]),!1,!0):e==="col"?new v("","",e,t,u([]),!1,!0):e==="embed"?new v("","",e,t,u([]),!1,!0):e==="hr"?new v("","",e,t,u([]),!1,!0):e==="img"?new v("","",e,t,u([]),!1,!0):e==="input"?new v("","",e,t,u([]),!1,!0):e==="link"?new v("","",e,t,u([]),!1,!0):e==="meta"?new v("","",e,t,u([]),!1,!0):e==="param"?new v("","",e,t,u([]),!1,!0):e==="source"?new v("","",e,t,u([]),!1,!0):e==="track"?new v("","",e,t,u([]),!1,!0):e==="wbr"?new v("","",e,t,u([]),!1,!0):new v("","",e,t,r,!1,!1)}function tn(e,t){if(Mi(e),e instanceof v){let r=e.namespace,n=e.tag,i=e.attrs,s=e.children,o=e.self_closing,l=e.void;return new v(t,r,n,i,s,o,l)}else if(e instanceof Ke){let r=e.subtree;return new Ke(()=>tn(r(),t))}else if(e instanceof ut){let n=e.elements,i=zr(n,(s,o)=>{if(s instanceof v){let l=s.key,p=l===""?t+"-"+j(o):t+"-"+l;return tn(s,p)}else return tn(s,t)});return new ut(i,t)}else return e}function rn(e,t){let r=e(E(t,n=>{let i=n[0],s=n[1];return tn(s,i)}));return Mi(r)}function vo(e){return new lt(e)}var Ni=class extends a{constructor(t){super(),this.dict=t}};function Oo(){return new Ni(J())}var nn=class extends a{constructor(t){super(),this[0]=t}},sn=class extends a{constructor(t,r){super(),this[0]=t,this[1]=r}},on=class extends a{constructor(t,r){super(),this[0]=t,this[1]=r}};function Eo(e){return k(e.created,J())&&k(e.removed,Oo())&&k(e.updated,J())}var ln=class extends a{constructor(t){super(),this[0]=t}},un=class extends a{constructor(t,r){super(),this[0]=t,this[1]=r}},Xt=class extends a{constructor(t){super(),this[0]=t}},$e=class extends a{constructor(t){super(),this[0]=t}},Qt=class extends a{constructor(t,r){super(),this[0]=t,this[1]=r}},an=class extends a{constructor(t,r){super(),this[0]=t,this[1]=r}};var er=class extends a{},pn=class extends a{constructor(t,r){super(),this[0]=t,this[1]=r}},cn=class extends a{constructor(t){super(),this[0]=t}},fn=class extends a{constructor(t){super(),this[0]=t}};function Pi(e,t,r){let n,i=[{prev:e,next:t,parent:e.parentNode}];for(;i.length;){let{prev:s,next:o,parent:l}=i.pop();for(;o.subtree!==void 0;)o=o.subtree();if(o.content!==void 0)if(s)if(s.nodeType===Node.TEXT_NODE)s.textContent!==o.content&&(s.textContent=o.content),n??=s;else{let p=document.createTextNode(o.content);l.replaceChild(p,s),n??=p}else{let p=document.createTextNode(o.content);l.appendChild(p),n??=p}else if(o.tag!==void 0){let p=Na({prev:s,next:o,dispatch:r,stack:i});s?s!==p&&l.replaceChild(p,s):l.appendChild(p),n??=p}else if(o.elements!==void 0)for(let p of dn(o))i.unshift({prev:s,next:p,parent:l}),s=s?.nextSibling}return n}function Na({prev:e,next:t,dispatch:r,stack:n}){let i=t.namespace||"http://www.w3.org/1999/xhtml",s=e&&e.nodeType===Node.ELEMENT_NODE&&e.localName===t.tag&&e.namespaceURI===(t.namespace||"http://www.w3.org/1999/xhtml"),o=s?e:i?document.createElementNS(i,t.tag):document.createElement(t.tag),l;if(tr.has(o))l=tr.get(o);else{let g=new Map;tr.set(o,g),l=g}let p=s?new Set(l.keys()):null,d=s?new Set(Array.from(e.attributes,g=>g.name)):null,h=null,x=null,y=null;if(s&&t.tag==="textarea"){let g=t.children[Symbol.iterator]().next().value?.content;g!==void 0&&(o.value=g)}for(let g of t.attrs){let b=g[0],S=g[1];if(g.as_property)o[b]!==S&&(o[b]=S),s&&d.delete(b);else if(b.startsWith("on")){let D=b.slice(2),he=r(S,D==="input");l.has(D)||o.addEventListener(D,rr),l.set(D,he),s&&p.delete(D)}else if(b.startsWith("data-lustre-on-")){let D=b.slice(15),he=r(Pa);l.has(D)||o.addEventListener(D,rr),l.set(D,he),o.setAttribute(b,S)}else b==="class"?h=h===null?S:h+" "+S:b==="style"?x=x===null?S:x+S:b==="dangerous-unescaped-html"?y=S:(o.getAttribute(b)!==S&&o.setAttribute(b,S),(b==="value"||b==="selected")&&(o[b]=S),s&&d.delete(b))}if(h!==null&&(o.setAttribute("class",h),s&&d.delete("class")),x!==null&&(o.setAttribute("style",x),s&&d.delete("style")),s){for(let g of d)o.removeAttribute(g);for(let g of p)l.delete(g),o.removeEventListener(g,rr)}if(t.key!==void 0&&t.key!=="")o.setAttribute("data-lustre-key",t.key);else if(y!==null)return o.innerHTML=y,o;let L=o.firstChild,Z=null,Oe=null,je=null,me=nr(t).next().value;if(s&&me!==void 0&&me.key!==void 0&&me.key!==""){Z=new Set,Oe=To(e),je=To(t);for(let g of nr(t))L=Fa(L,g,o,n,je,Oe,Z)}else for(let g of nr(t))n.unshift({prev:L,next:g,parent:o}),L=L?.nextSibling;for(;L;){let g=L.nextSibling;o.removeChild(L),L=g}return o}var tr=new WeakMap;function rr(e){let t=e.currentTarget;if(!tr.has(t)){t.removeEventListener(e.type,rr);return}let r=tr.get(t);if(!r.has(e.type)){t.removeEventListener(e.type,rr);return}r.get(e.type)(e)}function Pa(e){let t=e.currentTarget,r=t.getAttribute(`data-lustre-on-${e.type}`),n=JSON.parse(t.getAttribute("data-lustre-data")||"{}"),i=JSON.parse(t.getAttribute("data-lustre-include")||"[]");switch(e.type){case"input":case"change":i.push("target.value");break}return{tag:r,data:i.reduce((s,o)=>{let l=o.split(".");for(let p=0,d=s,h=e;p<l.length;p++)p===l.length-1?d[l[p]]=h[l[p]]:(d[l[p]]??={},h=h[l[p]],d=d[l[p]]);return s},{data:n})}}function To(e){let t=new Map;if(e)for(let r of nr(e)){let n=r?.key||r?.getAttribute?.("data-lustre-key");n&&t.set(n,r)}return t}function Fa(e,t,r,n,i,s,o){for(;e&&!i.has(e.getAttribute("data-lustre-key"));){let p=e.nextSibling;r.removeChild(e),e=p}if(s.size===0){for(let p of nr(t))n.unshift({prev:e,next:p,parent:r}),e=e?.nextSibling;return e}if(o.has(t.key))return console.warn(`Duplicate key found in Lustre vnode: ${t.key}`),n.unshift({prev:null,next:t,parent:r}),e;o.add(t.key);let l=s.get(t.key);if(!l&&!e)return n.unshift({prev:null,next:t,parent:r}),e;if(!l&&e!==null){let p=document.createTextNode("");return r.insertBefore(p,e),n.unshift({prev:p,next:t,parent:r}),e}return!l||l===e?(n.unshift({prev:e,next:t,parent:r}),e=e?.nextSibling,e):(r.insertBefore(l,e),n.unshift({prev:l,next:t,parent:r}),e)}function*nr(e){for(let t of e.children)yield*dn(t)}function*dn(e){if(e.elements!==void 0)for(let t of e.elements)yield*dn(t);else e.subtree!==void 0?yield*dn(e.subtree()):yield e}var Fi=class e{static start({init:t,update:r,view:n},i,s){if(!Di())return new f(new ir);let o=i instanceof HTMLElement?i:document.querySelector(i);if(!o)return new f(new _n(i));let l=new e(o,t(s),r,n);return new c(p=>l.send(p))}constructor(t,[r,n],i,s){this.root=t,this.#e=r,this.#s=i,this.#r=s,this.#t=window.requestAnimationFrame(()=>this.#n(n.all.toArray(),!0))}root;send(t){if(t instanceof Xt){if(t[0]instanceof fn){this.#t=window.cancelAnimationFrame(this.#t),this.#i=[],this.#e=t[0][0];let r=this.#r(this.#e),n=(s,o=!1)=>l=>{let p=s(l);p instanceof c&&this.send(new $e(p[0],o))},i=this.root.firstChild??this.root.appendChild(document.createTextNode(""));Pi(i,r,n)}}else if(t instanceof $e){let r=t[0],n=t[1]??!1;this.#i.push(r),n?(this.#t=window.cancelAnimationFrame(this.#t),this.#n()):this.#t||(this.#t=window.requestAnimationFrame(()=>this.#n()))}else if(t instanceof Qt){let r=t[0],n=t[1];this.root.dispatchEvent(new CustomEvent(r,{detail:n,bubbles:!0,composed:!0}))}else if(t instanceof er)for(this.#t=window.cancelAnimationFrame(this.#t),this.#e=null,this.#s=null,this.#r=null,this.#i=null;this.root.firstChild;)this.root.firstChild.remove()}#e;#s;#r;#i=[];#t;#n(t=[],r=!1){if(this.#t=void 0,!this.#o(t,r))return;let n=this.#r(this.#e),i=(o,l=!1)=>p=>{let d=o(p);d instanceof c&&this.send(new $e(d[0],l))},s=this.root.firstChild??this.root.appendChild(document.createTextNode(""));Pi(s,n,i)}#o(t=[],r=!1){for(;this.#i.length>0;){let n=this.#i.shift(),[i,s]=this.#s(this.#e,n);r||=this.#e!==i,t=t.concat(s.all.toArray()),this.#e=i}for(;t.length>0;)t.shift()({dispatch:l=>this.send(new $e(l)),emit:(l,p)=>this.root.dispatchEvent(new CustomEvent(l,{detail:p,bubbles:!0,composed:!0})),select:()=>{}});return this.#i.length>0?this.#o(t,r):r}},So=Fi.start;var Ii=class e{static start({init:t,update:r,view:n,on_attribute_change:i},s){let o=new e(t(s),r,n,i);return new c(l=>o.send(l))}constructor([t,r],n,i,s){this.#e=t,this.#s=n,this.#i=i,this.#t=i(t),this.#u=s,this.#n=new Map,this.#o=yo(this.#t),this.#l(r.all.toArray())}send(t){if(t instanceof ln){for(let r of t[0]){let n=this.#u.get(r[0]);if(!n)continue;let i=n(r[1]);i instanceof f||this.#r.push(i)}this.#l()}else if(t instanceof un)this.#r=this.#r.concat(t[0].toArray()),this.#l(t[1].all.toArray());else if(!(t instanceof Xt))if(t instanceof $e)this.#r.push(t[0]),this.#l();else if(t instanceof Qt){let r=new sn(t[0],t[1]);for(let[n,i]of this.#n)i(r)}else if(t instanceof an){let r=this.#o.get(t[0]);if(!r)return;let n=r(t[1]);if(n instanceof f)return;this.#r.push(n[0]),this.#l()}else if(t instanceof pn){let r=Jr(this.#u),n=new on(r,this.#t);this.#n=this.#n.set(t[0],t[1]),t[1](n)}else t instanceof cn&&(this.#n=this.#n.delete(t[0]))}#e;#s;#r;#i;#t;#n;#o;#u;#l(t=[]){if(!this.#a(!1,t))return;let r=this.#i(this.#e),n=elements(this.#t,r);if(!Eo(n)){let i=new nn(n);for(let[s,o]of this.#n)o(i)}this.#t=r,this.#o=n.handlers}#a(t=!1,r=[]){for(;this.#r.length>0;){let n=this.#r.shift(),[i,s]=this.#s(this.#e,n);t||=this.#e!==i,r=r.concat(s.all.toArray()),this.#e=i}for(;r.length>0;)r.shift()({dispatch:l=>this.send(new $e(l)),emit:(l,p)=>this.root.dispatchEvent(new CustomEvent(l,{detail:p,bubbles:!0,composed:!0})),select:()=>{}});return this.#r.length>0?this.#a(t,r):t}},Ia=Ii.start,Di=()=>globalThis.window&&window.document;var Gi=class extends a{constructor(t,r,n,i){super(),this.init=t,this.update=r,this.view=n,this.on_attribute_change=i}};var _n=class extends a{constructor(t){super(),this.selector=t}},ir=class extends a{};function Co(e,t,r){return new Gi(e,t,r,new _)}function qo(e,t,r){return be(!Di(),new f(new ir),()=>So(e,t,r))}var ct=class e{constructor(t){this.promise=t}static wrap(t){return t instanceof Promise?new e(t):t}static unwrap(t){return t instanceof e?t.promise:t}};function $n(e){return Promise.resolve(ct.wrap(e))}function Mo(e,t){return e.then(r=>t(ct.unwrap(r)))}function mn(e,t){return e.then(r=>ct.wrap(t(ct.unwrap(r))))}function Bi(e,t){return e.catch(r=>t(r))}function zo(e,t){return mn(e,n=>(t(n),n))}function hn(e,t){return Mo(e,n=>{if(n.isOk()){let i=n[0];return t(i)}else{let i=n[0];return $n(new f(i))}})}function Hi(e){return new Audio(e)}async function Ri(e){try{return await e.play(),new c}catch(t){return new f(t.toString())}}function _t(e){let t=document.getElementById(e);return t?new c(t):new f}function Ui(e){let t=e.value;return t!=null?new c(t):new f}function Ra(){return globalThis}function Ua(e){window.alert(e)}function Wa(e,t){return window.addEventListener(e,t)}async function Ja(){try{return new c(await window.navigator.wakeLock.request("screen"))}catch(e){return new f(e.toString())}}function Wi(){return window.location.href}function Ka(e){try{return new c(e.location.href)}catch(t){return new f(t.toString())}}function Va(e,t){e.location.href=t}function Ya(){return window.location.reload()}function Za(e){return e.location.reload()}function Xa(e){return e.focus()}function Qa(){let e=window.location.hash;return e==""?new f:new c(decodeURIComponent(e.slice(1)))}function ep(){let e=window.location.search;return e==""?new f:new c(decodeURIComponent(e.slice(1)))}function tp(e){return e.innerHeight}function rp(e){return e.innerWidth}function np(e){return e.outerHeight}function ip(e){return e.outerWidth}function sp(e){return e.screenX}function op(e){return e.screenY}function lp(e){return e.screenTop}function up(e){return e.screenLeft}function ap(e){return e.scrollX}function pp(e){return e.scrollY}function cp(e,t,r){try{return new c(window.open(e,t,r))}catch(n){return new f(n.toString())}}function fp(e){e.close()}function dp(e){return e.closed}function _p(e){return window.queueMicrotask(e)}function $p(e){return window.requestAnimationFrame(e)}function mp(e){return window.cancelAnimationFrame(e)}function hp(string){try{return new c(eval(string))}catch(e){return new f(e.toString())}}async function wp(e){try{return new c(await import(e))}catch(t){return new f(t.toString())}}function Ji(e){console.warn(e)}function wn(e){console.error(e)}function I(e){return vo(e)}function Io(e,t){return R("aside",e,t)}function xn(e,t){return R("h1",e,t)}function Do(e,t){return R("h3",e,t)}function B(e,t){return R("div",e,t)}function gn(e,t){return R("li",e,t)}function yn(e,t){return R("ul",e,t)}function Go(e,t){return R("a",e,t)}function $t(e,t){return R("span",e,t)}function mt(e){return R("img",e,u([]))}function Ve(e,t){return R("button",e,t)}function bn(e){return R("input",e,u([]))}function Bo(e,t){return R("label",e,t)}function Ho(e,t){return R("dialog",e,t)}var ne=class extends a{},Ye=class extends a{},kn=class extends a{},An=class extends a{},sr=class extends a{},Ln=class extends a{},vn=class extends a{},On=class extends a{},jn=class extends a{};var Le=class extends a{},Ze=class extends a{};function Ro(e){return e instanceof vn?"connect":e instanceof sr?"delete":e instanceof ne?"get":e instanceof kn?"head":e instanceof On?"options":e instanceof jn?"patch":e instanceof Ye?"post":e instanceof An?"put":e instanceof Ln?"trace":e[0]}function Uo(e){return e instanceof Le?"http":"https"}var En=class extends a{constructor(t,r,n,i,s,o,l,p){super(),this.method=t,this.headers=r,this.body=n,this.scheme=i,this.host=s,this.port=o,this.path=l,this.query=p}};function Yo(e){return new Jt(new $(Uo(e.scheme)),new _,new $(e.host),e.port,e.path,e.query,new _)}function Ki(e,t,r){let n=Pr(e.headers,ze(t),r);return e.withFields({headers:n})}function Tn(e,t){let r=e.method,n=e.headers,i=e.scheme,s=e.host,o=e.port,l=e.path,p=e.query;return new En(r,n,t,i,s,o,l,p)}function Zo(e,t){let r=i=>qe(u([Ei(i[0]),"=",Ei(i[1])])),n=(()=>{let s=E(t,r),o=Nr(s,Nt("&")),l=ni(o),p=K(l);return new $(p)})();return e.withFields({query:n})}function Vi(e,t){return e.withFields({method:t})}function Xo(){return new En(new ne,u([]),"",new Ze,"localhost",new _,"",new _)}function Qo(e,t){return e.withFields({scheme:t})}function tl(e,t){return e.withFields({host:t})}function rl(e,t){return e.withFields({port:new $(t)})}function nl(e,t){return e.withFields({path:t})}var ve=class extends a{constructor(t,r,n){super(),this.status=t,this.headers=r,this.body=n}};async function sl(e){try{return new c(await fetch(e))}catch(t){return new f(new Sn(t.toString()))}}function ol(e){return new ve(e.status,C.fromArray([...e.headers]),e)}function ll(e){let t=co(Yo(e)),r=Ro(e.method).toUpperCase(),n={headers:Ap(e.headers),method:r};return r!=="GET"&&r!=="HEAD"&&(n.body=e.body),new globalThis.Request(t,n)}function Ap(e){let t=new globalThis.Headers;for(let[r,n]of e)t.append(r.toLowerCase(),n);return t}async function Yi(e){let t;try{t=await e.body.text()}catch{return new f(new Cn)}return new c(e.withFields({body:t}))}var Sn=class extends a{constructor(t){super(),this[0]=t}},Cn=class extends a{};function ul(e){let r=ll(e),n=sl(r);return hn(n,i=>$n(new c(ol(i))))}var Zi=class extends a{constructor(t){super(),this[0]=t}},qn=class extends a{constructor(t){super(),this[0]=t}},Mn=class extends a{},Xi=class extends a{},or=class extends a{constructor(t,r){super(),this[0]=t,this[1]=r}},Qi=class extends a{},es=class extends a{constructor(t){super(),this.run=t}};function vp(e,t,r){let n=ul(e),i=hn(n,Yi),s=mn(i,l=>{if(l.isOk()){let p=l[0];return t.run(new c(p))}else return t.run(new f(new Mn))}),o=Bi(s,l=>t.run(new f(new Mn)));zo(o,r)}function al(e,t){return W(r=>vp(e,t,r))}function Op(e){if(e instanceof ve&&200<=e.status&&e.status<=299){let t=e.status,r=e.body;return new c(r)}else{if(e instanceof ve&&e.status===401)return new f(new Qi);if(e instanceof ve&&e.status===404)return new f(new Xi);if(e instanceof ve&&e.status===500){let t=e.body;return new f(new Zi(t))}else{let t=e.status,r=e.body;return new f(new or(t,r))}}}function pl(e){return new es(t=>{let n=q(t,Op);return e(n)})}var ts=class extends a{constructor(t,r,n,i,s,o,l){super(),this.id=t,this.title=r,this.artists=n,this.album=i,this.album_cover=s,this.source=o,this.preview_url=l}},zn=class extends a{constructor(t){super(),this.url=t}},rs=class extends a{constructor(t){super(),this.url=t}};function Ep(e){if(e instanceof zn){let t=e.url;return Fe(u([["source",F("youtube")],["url",F(t)]]))}else{let t=e.url;return Fe(u([["source",F("spotify")],["url",F(t)]]))}}function Nn(e){return Fe(u([["id",F(e.id)],["title",F(e.title)],["artists",(()=>{let t=e.artists;return ke(t,F)})()],["album",F(e.album)],["album_cover",F(e.album_cover)],["source",Ep(e.source)],["preview_url",wo(e.preview_url,F)]]))}function Tp(e){let t=(()=>{let r=e;return z("source",M)(r)})();if(t.isOk()&&t[0]==="youtube"){let r=e,n=z("url",M)(r);return T(n,i=>new zn(i))}else if(t.isOk()&&t[0]==="spotify"){let r=e,n=z("url",M)(r);return T(n,i=>new rs(i))}else if(t.isOk()){let r=t[0];return new f(u([new V("Wrong source name",r,u(["source"]))]))}else{let r=t[0];return new f(r)}}function Pn(e){let t=e;return Is((r,n,i,s,o,l,p)=>new ts(r,n,i,s,o,l,p),z("id",M),z("title",M),z("artists",fe(M)),z("album",M),z("album_cover",M),z("source",Tp),z("preview_url",Fs(M)))(t)}var ns=class extends a{constructor(t,r,n){super(),this.id=t,this.name=r,this.songs=n}},lr=class extends a{constructor(t){super(),this.name=t}};function fl(e){return Fe(u([["id",F(e.id)],["name",F(e.name)],["songs",ke(e.songs,Nn)]]))}function dl(e){let t=e;return fi((r,n,i)=>new ns(r,n,i),z("id",M),z("name",M),z("songs",fe(Pn)))(t)}function _l(e){return Fe(u([["name",F(e.name)]]))}function $l(e){let t=e;return ui(r=>new lr(r),z("name",M))(t)}var wt=class extends a{constructor(t){super(),this.search=t}},xt=class extends a{constructor(t){super(),this.results=t}},gt=class extends a{constructor(t){super(),this.error=t}},oe=class extends a{constructor(t){super(),this.message=t}},yt=class extends a{constructor(t){super(),this.preview_url=t}},bt=class extends a{constructor(t){super(),this.playlists=t}},kt=class extends a{constructor(t){super(),this.id=t}},Xe=class extends a{constructor(t){super(),this.id=t}},At=class extends a{constructor(t){super(),this.name=t}},ur=class extends a{constructor(t){super(),this.playlist=t}},Lt=class extends a{constructor(t){super(),this.playlist=t}},ar=class extends a{constructor(t){super(),this.playlist=t}},pr=class extends a{constructor(t){super(),this.id=t}};function hl(){return u([Do(u([w("text-lg mb-4 text-center")]),u([I("Search songs and create playlists that can be exported to Spotify, Youtube Music,...")])),Go(u([Lo("/login"),w("text-green-400 bg-zinc-700 hover:bg-zinc-600 rounded-md font-bold flex gap-2 py-2 px-4")]),u([mt(u([pt("https://storage.googleapis.com/pr-newsroom-wp/1/2023/05/Spotify_Primary_Logo_RGB_Green.png"),w("h-6")])),I("Login to Spotify")]))])}function wl(e,t){return B(u([w("bg-zinc-800 min-w-screen min-h-screen text-pink-100 p-4 flex flex-nowrap items-stretch")]),u([Io(u([w("w-1/8 md:w-1/6 lg:w-1/4 max-w-lg bg-zinc-900 rounded-lg")]),t),B(u([w("w-3/4 md:w-2/3 lg:w-1/2 max-w-3xl flex-1 flex flex-col items-center py-8")]),m(xn(u([w("text-4xl font-bold mb-8")]),u([I("Playlist Maker")])),e))]))}function Ge(e,t){return ko(e,t)}function Mp(e){let t=_t("create-playlist-name");if(t.isOk()){let r=t[0],n=Ui(r);if(n.isOk()){let i=n[0];return new c(new At(i))}else return new c(new oe("Couldn't get value of element"))}else return new c(new oe("Couldn't find element with id create-playlist-name"))}function xl(){return Ho(u([Zt("create-playlist"),w("p-4 rounded-lg backdrop:bg-zinc-900 backdrop:opacity-80")]),u([xn(u([w("text-2xl font-bold mb-4")]),u([I("Create a new playlist")])),B(u([w("flex flex-col gap-4")]),u([Bo(u([w("flex gap-2 items-center")]),u([$t(u([]),u([I("Playlist name")])),bn(u([Zt("create-playlist-name"),Ao("Playlist name..."),w("p-2 rounded-md bg-zinc-100 focus:bg-zinc-200")]))])),B(u([w("flex justify-end")]),u([Ve(u([w("p-2 bg-zinc-100"),Ge("click",e=>new c(new Xe("create-playlist")))]),u([I("Close")])),Ve(u([w("p-2 bg-green-500 text-zinc-100"),Ge("click",Mp)]),u([I("Create")]))]))]))]))}function gl(e){return u([B(u([w("p-2 flex flex-col gap-2 items-stretch")]),u([rn(t=>yn(u([w("flex flex-col items-stretch")]),t),E(e,t=>{let r=gn(u([]),u([I(t[1].name)]));return[t[0],r]})),Ve(u([w("text-center font-bold border border-zinc-100 bg-zinc-900 hover:bg-zinc-800/50 rounded-md py-2 px-4"),Ge("click",t=>new c(new kt("create-playlist")))]),u([I("+ Create playlist")]))])),xl()])}function Vp(e,t){return r=>N(fe(Br)(r),n=>{if(e>=0){let o=Mt(n,e),l=Ct(o),p=ti(l,u([new V("A list with at least"+j(e+1)+"elements","A list with"+j(Zn(n))+"elements",u([j(e)]))]));return q(p,t)}else return new f(u([new V("An 'index' decoder with a non-negative index",j(e),u([]))]))})}function Yp(e,t){return Hr(u([ci(e,t),z(j(e),t),Vp(e,t)]))}function ss(e,t,r){if(e.hasLength(0))return t(r);{let n=e.head,i=e.tail,s=Se(n);if(s.isOk()){let o=s[0],l=r,p=Yp(o,Br)(l);return q(p,d=>ss(i,t,d))}else{let o=r,l=z(n,Br)(o);return q(l,p=>ss(i,t,p))}}}function yl(e,t){return r=>ss(e,t,r)}function bl(){return B(u([w("mt-8 w-8 h-8 animate-spin rounded-full border-2 border-t-zinc-800 border-x-zinc-800/50 border-b-zinc-800/50")]),u([]))}function Qp(e){let t=e,r=yl(u(["target","previousElementSibling","value"]),M)(t);return T(r,n=>new wt(n))}function ec(e){let t=e.preview_url;if(t instanceof $){let r=t[0];return B(u([w("group relative")]),u([mt(u([pt(e.album_cover),w("w-16 h-16 rounded-sm"),Ge("click",n=>new c(new yt(r)))])),B(u([w("absolute w-full h-full top-0 left-0 group-hover:opacity-100 bg-zinc-100/50 p-2 opacity-0 transition-opacity duration-300")]),u([mt(u([pt("https://www.svgrepo.com/download/524827/play-circle.svg")]))]))]))}else return B(u([]),u([mt(u([pt(e.album_cover),w("w-16 h-16 rounded-sm")]))]))}function tc(e){return B(u([w("flex items-center gap-4 py-4 px-8 bg-zinc-700/50 hover:bg-zinc-700/80")]),u([ec(e),B(u([w("flex flex-col flex-1")]),u([$t(u([w("font-semibold")]),u([I(e.title)])),$t(u([w("text-sm text-zinc-100/70")]),u([I((()=>{let t=e.artists;return Q(t," - ")})())])),$t(u([w("text-sm text-zinc-100/70")]),u([I(e.album)]))]))]))}function rc(e){return rn(t=>yn(u([w("rounded-lg overflow-clip mt-8 w-full")]),t),E(e,t=>{let r=gn(u([]),u([tc(t)]));return[t.id,r]}))}function kl(e,t){return u([B(u([w("rounded-md overflow-clip flex items-stretch")]),u([bn(u([w("py-2 px-4 bg-zinc-700/30 hover:bg-zinc-700/70 focus:bg-zinc-600/80"),Zt("search-songs")])),Ve(u([w("bg-zinc-700 hover:bg-zinc-600 py-2 px-4"),Ge("click",Qp)]),u([I("Search")]))])),e?bl():rc(t)])}var Be=class extends a{constructor(t){super(),this.msg=t}},Fn=class extends a{constructor(t){super(),this.err=t}};var cr=class extends a{},In=class extends a{},vt=class extends a{},Dn=class extends a{constructor(t,r){super(),this.encoder=t,this.decoder=r}},Gn=class extends a{constructor(t,r){super(),this.btype=t,this.converter=r}};function ls(){return new Gn(new cr,new Dn(e=>ri(),e=>new c(void 0)))}function Ot(e,t){return new Gn(new vt,new Dn(r=>{let i=e(r);return ho(i)},r=>{let n=Qr(r,t);return pe(n,i=>new Fn(i))}))}function us(e,t){let r=t;return e.converter.encoder(r)}function Al(e,t){let r=t;return e.converter.decoder(r)}function Ll(e){return e.btype}var as=class extends a{};var ps=class extends a{constructor(t,r){super(),this.encoder=t,this.decoder=r}},cs=class extends a{constructor(t,r){super(),this.ptype=t,this.converter=r}};function et(e){return new cs(new as,new ps(t=>e,t=>be(k(t,e),new c(void 0),()=>new f(void 0))))}function vl(e,t){let r=t;return e.converter.encoder(r)}function Ol(e){return e.ptype}var fr=class extends a{},dr=class extends a{},_r=class extends a{constructor(t,r){super(),this.encoder=t,this.decoder=r}},Rn=class extends a{constructor(t,r){super(),this.qtype=t,this.converter=r}};function jl(){return new Rn(new fr,new _r(e=>u([]),e=>new c(void 0)))}function El(e){return new Rn(new dr,e)}function Tl(e,t){let r=t;return e.converter.encoder(r)}function Sl(e){return e.qtype}var tt=class extends a{constructor(t,r,n,i,s){super(),this.method=t,this.path=r,this.query=n,this.req_body=i,this.res_body=s}};function $r(){return new tt(new ne,et(u([])),jl(),ls(),ls())}function mr(e,t){return e.withFields({method:t})}function hr(e,t){return new tt(e.method,t,e.query,e.req_body,e.res_body)}function Cl(e,t){return new tt(e.method,e.path,t,e.req_body,e.res_body)}function ql(e,t){return new tt(e.method,e.path,e.query,t,e.res_body)}function wr(e,t){return new tt(e.method,e.path,e.query,e.req_body,t)}var xr=class extends a{constructor(t,r,n){super(),this.scheme=t,this.host=r,this.port=n}},ds=class extends a{constructor(t,r,n,i,s,o,l){super(),this.route=t,this.scheme=r,this.host=n,this.port=i,this.path_opt=s,this.query_opt=o,this.body_opt=l}};function zl(){return new xr(new Le,"localhost",80)}function Nl(e,t){return t instanceof Le?new xr(new Le,e.host,80):new xr(new Ze,e.host,443)}function Pl(e,t){return e.withFields({host:t})}function Fl(e,t){return e.withFields({port:t})}function gr(e,t){return new ds(t,e.scheme,e.host,e.port,new _,new _,new _)}function yr(e,t){return e.withFields({path_opt:new $(t)})}function Il(e,t){return e.withFields({query_opt:new $(t)})}function Dl(e,t){return e.withFields({body_opt:new $(t)})}function ic(e,t,r,n){let i=(()=>{let o=t.route.path;return Ol(o)})(),s=t.path_opt;if(s instanceof _)return r("Path option is missing, please call with_path before send");{let o=s[0];return n(nl(e,(()=>{let p=t.route.path,d=vl(p,o);return Q(d,"/")})()))}}function sc(e,t,r,n){let i=(()=>{let o=t.route.query;return Sl(o)})(),s=t.query_opt;if(i instanceof dr&&s instanceof _)return r("Query option is missing, please call with_query before send");if(i instanceof fr)return n(e);{let o=s[0];return n(Zo(e,(()=>{let p=t.route.query;return Tl(p,o)})()))}}function oc(e,t,r,n){let i=(()=>{let o=t.route.req_body;return Ll(o)})(),s=t.body_opt;if(i instanceof vt&&s instanceof _)return r("Body option is missing, please call with_body before send");if(i instanceof In&&s instanceof _)return r("Body option is missing, please call with_body before send");if(i instanceof cr)return n(e);if(i instanceof vt&&s instanceof $){let o=s[0];return n((()=>{let p=Tn(e,(()=>{let d=t.route.req_body,h=us(d,o);return K(h)})());return Ki(p,"Content-Type","application/json")})())}else{let o=s[0];return n(Tn(e,(()=>{let p=t.route.req_body,d=us(p,o);return K(d)})()))}}function lc(e){if(e instanceof Be){let t=e.msg;return new or(500,t)}else{let t=e.err;return new qn(t)}}function Un(e,t,r){let n=(()=>{let i=Xo();return Vi(i,e.route.method)})();return ic(n,e,r,i=>sc(i,e,r,s=>oc(s,e,r,o=>{let p=(()=>{let h=Qo(o,e.scheme),x=tl(h,e.host);return rl(x,e.port)})();return al(p,pl(d=>{let x=q(d,y=>{let L=e.route.res_body,Z=Al(L,y);return pe(Z,lc)});return t(x)}))})))}var br=class extends a{constructor(t,r,n){super(),this.root_path=t,this.base=r,this.upsert=n}};function Gl(){return new br(u([]),new _,new _)}function Bl(e,t){return e.withFields({root_path:t})}function Hl(e,t,r){return new br(e.root_path,new $([t,r]),e.upsert)}function Rl(e,t,r){return new br(e.root_path,e.base,new $([t,r]))}function Ul(e){let t=e.upsert,r=e.base;if(t instanceof _)return new f(new Be("No upsert type provided, make sure you called with_upsert_type"));if(r instanceof _)return new f(new Be("No base type provided, make sure you called with_base_type"));{let n=t[0],i=r[0],s=$r(),o=mr(s,new Ye),l=hr(o,et(e.root_path)),p=ql(l,Ot(n[0],n[1])),d=wr(p,Ot(i[0],i[1]));return new c(d)}}function Wl(e){let t=e.base;if(t instanceof _)return new f(new Be("No base type provided, make sure you called with_base_type"));{let r=t[0],n=$r(),i=mr(n,new ne),s=hr(i,et(e.root_path)),o=wr(s,Ot(l=>ke(l,r[0]),fe(r[1])));return new c(o)}}function Jl(){let e=Gl(),t=Bl(e,u(["playlists"])),r=Hl(t,fl,dl);return Rl(r,_l,$l)}function Kl(){let e=Jl();return Wl(e)}function Vl(){let e=Jl();return Ul(e)}function kr(){let e=zl(),t=Nl(e,new Le),r=Pl(t,"localhost");return Fl(r,2345)}function _s(e){!e||!(e instanceof HTMLDialogElement)||e.showModal()}function $s(e){!e||!(e instanceof HTMLDialogElement)||e.close()}function ms(e,t){return Un(e,n=>{if(n.isOk()){let i=n[0];return t(i)}else{let i=n[0];return new gt(i)}},n=>W(i=>i(new oe(n))))}function hs(e,t){if(e.isOk()){let r=e[0];return t(r)}else{let r=e[0];return W(n=>Ji(r))}}function Xl(){return hs(Kl(),e=>{let t=kr(),r=gr(t,e),n=yr(r,void 0);return ms(n,i=>new bt(i))})}function Ql(e){return hs(Vl(),t=>{let r=kr(),n=gr(r,t),i=yr(n,void 0),s=Dl(i,new lr(e));return ms(s,o=>new Lt(o))})}var Ar=class extends a{constructor(t,r){super(),this.search=t,this.token=r}};function cc(e){return u([["q",e.search],["token",e.token]])}function fc(e){return N(ge(e,"q"),t=>N(ge(e,"token"),r=>new c(new Ar(t,r))))}function eu(){let e=$r(),t=mr(e,new ne),r=hr(t,et(u(["songs","search"]))),n=Cl(r,El(new _r(cc,fc)));return wr(n,Ot(i=>ke(i,Nn),fe(Pn)))}function tu(e,t){let r=kr(),n=gr(r,eu()),i=yr(n,void 0),s=Il(i,new Ar(e,t));return Un(s,o=>{if(o.isOk()){let l=o[0];return new xt(l)}else{let l=o[0];return new gt(l)}},o=>W(l=>l(new oe(o))))}var Lr=class extends a{constructor(t,r,n,i,s){super(),this.token=t,this.last_search=r,this.searching=n,this.results=i,this.playlists=s}};function $c(e){let t=(()=>{let r=Vr(Wi()),n=q(r,s=>ji((()=>{let o=s.query;return Te(o,"")})())),i=q(n,s=>ge(s,"token"));return Re(i,"")})();return[new Lr(t,"",!1,u([]),J()),Xl()]}function mc(e,t){if(t instanceof wt){let r=t.search;return[e.withFields({last_search:r,searching:!0}),tu(r,e.token)]}else if(t instanceof xt){let r=t.results;return[e.withFields({searching:!1,results:r}),Je()]}else if(t instanceof bt){let r=t.playlists;return[e.withFields({playlists:Rr(E(r,i=>[i.id,i]))}),Je()]}else if(t instanceof yt){let r=t.preview_url;return[e,W(n=>{let i=Hi(r);Ri(i)})]}else if(t instanceof kt){let r=t.id;return[e,W(n=>{let i=_t(r),s=T(i,_s);return Re(s,void 0)})]}else if(t instanceof At){let r=t.name;return[e,Ql(r)]}else if(t instanceof Lt){let r=t.playlist;return[e.withFields({playlists:(()=>{let n=e.playlists;return ie(n,r.id,r)})()}),W(n=>n(new Xe("create-playlist")))]}else if(t instanceof ar){let r=t.playlist;return[e.withFields({playlists:(()=>{let n=e.playlists;return ie(n,r.id,r)})()}),Je()]}else if(t instanceof ur){let r=t.playlist;return[e.withFields({playlists:(()=>{let n=e.playlists;return ie(n,r.id,r)})()}),Je()]}else if(t instanceof pr){let r=t.id;return[e.withFields({playlists:(()=>{let n=e.playlists;return uo(n,u([r]))})()}),Je()]}else if(t instanceof Xe){let r=t.id;return[e,W(n=>{let i=_t(r),s=T(i,$s);return Re(s,void 0)})]}else if(t instanceof oe){let r=t.message;return[e,W(n=>wn(r))]}else{let r=t.error;return[e,W(n=>wn(r))]}}function hc(e){let t=(()=>{if(e instanceof Lr&&e.token===""){let n=e.token;return hl()}else{let n=e.searching,i=e.results;return kl(n,i)}})(),r=gl((()=>{let n=e.playlists;return st(n)})());return wl(t,r)}function ru(){let e=Co($c,mc,hc),t=qo(e,"#app",void 0);if(!t.isOk())throw Ee("assignment_no_match","client",27,"main","Assignment pattern did not match",{value:t})}ru();
